/*! permutive-javascript-sdk v9.9.1 (web) (built 2020-04-02 16:20:15 GMT+0000) */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t,n){"use strict";(function(e){function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e=e||{};for(var r=1;r<arguments.length;r++)if(arguments[r])for(var i in arguments[r])e[i]=arguments[r][i];return e}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNestedObjects=function(e,t){return[e,t].reduce(function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e},{})},t.merge=function(e,t){return n(e,t)},t.extend=n,t.swap=function(e){var t={};for(var n in e)t[e[n]]=n;return t},t.filterByKey=function(e,t){return Object.keys(e).filter(t).reduce(function(t,n){return t[n]=e[n],t},{})},t.lens=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return e?e[t]:void 0},e)},t.hash=function(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t},t.deferredPromise=function(){var t,n;return{promise:new e(function(e,r){t=e,n=r}),reject:n,resolve:t}},t.poller=function(e,t,n){void 0===n&&(n=30);var r=0,i=!1;return function e(t,s,a){if(!(i||r>=n)){var o=null;try{o=t()}catch(e){return}o?s():setTimeout(function(){r++,e(t,s,2*a)},a)}}(e,t,50),{cancel:function(){i=!0}}},t.findIndex=function(e,t){for(var n=-1,r=0;r<e.length;r++){var i=e[r];if(t(i)){n=e.indexOf(i);break}}return n},t.forP=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n){return t.reduce(function(t,n){return e.resolve(t).then(n)},n)}},t.nonPrimitiveEq=function e(t,n){var r,i=function(e){return Object.keys(t).every(e)};switch(r=t,{}.toString.call(r).match(/\[object (\w+)\]/)[1]){case"Array":return t.length===n.length&&i(function(r){return e(t.sort()[r],n.sort()[r])});case"Object":return Object.keys(t).length===Object.keys(n).length&&i(function(r){return e(t[r],n[r])});default:return t===n}},t.numericStringToNumber=function(e){if("string"==typeof e){var t=+e;if(!isNaN(t))return t}return e},t.onPageUnload=function(e){var t=function(t){if(!n&&t)return n=!0,e()},n=!1;["blur","visibilitychange"].forEach(function(e){window.addEventListener(e,function(){return t(document.hidden&&/Mobi|Android/i.test(navigator.userAgent))})}),["beforeunload","pagehide"].forEach(function(e){window.addEventListener(e,function(){return t(!0)})})},t.uuidv4=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}}).call(this,n(1).Promise)},function(e,t,n){"use strict";var r=n(4).Promise,i=n(25).polyfill;t.Promise=r,t.polyfill=i},function(e,t,n){"use strict";function r(e){return"function"==typeof e}var i=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=function(e){return r(e)||"object"==typeof e&&null!==e},t.isFunction=r,t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.now=i},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeEvent=function(e){return r({id:e.id,name:e.name,time:new Date(e.time),properties:e.properties||{}},i(e))},t.serializeEvent=function(e){return r({id:e.id||null,name:e.name,time:(s(e.time)?e.time:new Date).toISOString(),properties:e.properties||{}},i(e))},t.deserializeMinimalEvent=function(e,t){return r({id:e.id,time:new Date(e.time),name:t.name,properties:t.properties},i(t))},t.isEventTrackError=function(e){return void 0!==e.request_id},t.isFullPermutiveEventJson=function(e){return void 0!==e.properties};var i=function(e){return r({},e.session_id?{session_id:e.session_id}:{},e.view_id?{view_id:e.view_id}:{})},s=function(e){return isFinite(e)&&e instanceof Date}},function(e,t,n){"use strict";var r=n(5).config,i=(n(5).configure,n(2).objectOrFunction),s=n(2).isFunction,a=(n(2).now,n(18).cast),o=n(19).all,c=n(20).race,u=n(21).resolve,l=n(22).reject,d=n(23).asap;function f(e){if(!s(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof f))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],function(e,t){function n(e){S(t,e)}try{e(function(e){b(t,e)},n)}catch(e){n(e)}}(e,this)}function p(e,t,n,r){var i,a,o,c,u=s(n);if(u)try{i=n(r),o=!0}catch(e){c=!0,a=e}else i=r,o=!0;w(t,i)||(u&&o?b(t,i):c?S(t,a):e===g?b(t,i):e===h&&S(t,i))}r.async=d;var _=void 0,m=0,g=1,h=2;function v(e,t,n,r){var i=e._subscribers,s=i.length;i[s]=t,i[s+g]=n,i[s+h]=r}function y(e,t){for(var n=e._subscribers,r=e._detail,i=0;i<n.length;i+=3)p(t,n[i],n[i+t],r);e._subscribers=null}function w(e,t){var n,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(i(t)&&(r=t.then,s(r)))return r.call(t,function(r){if(n)return!0;n=!0,t!==r?b(e,r):k(e,r)},function(t){if(n)return!0;n=!0,S(e,t)}),!0}catch(t){return!!n||(S(e,t),!0)}return!1}function b(e,t){e===t?k(e,t):w(e,t)||k(e,t)}function k(e,t){e._state===_&&(e._state=m,e._detail=t,r.async(P,e))}function S(e,t){e._state===_&&(e._state=m,e._detail=t,r.async(E,e))}function P(e){y(e,e._state=g)}function E(e){y(e,e._state=h)}f.prototype={constructor:f,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,i=new this.constructor(function(){});if(this._state){var s=arguments;r.async(function(){p(n._state,i,s[n._state-1],n._detail)})}else v(this,i,e,t);return i},catch:function(e){return this.then(null,e)}},f.all=o,f.cast=a,f.race=c,f.resolve=u,f.reject=l,t.Promise=f},function(e,t,n){"use strict";var r={instrument:!1};t.config=r,t.configure=function(e,t){if(2!==arguments.length)return r[e];r[e]=t}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(e,t){this._internals=e,this.network=t,this.identities=this._internals.state.getPermutiveData("identities")||{},this.currentAliases=this._internals.state.getPermutiveData("aliases")||{},this.providers={}}return t.getAliasesFromIdentifyArg=function(e){if("string"!=typeof e&&"object"!=typeof e||null===e||""===e)throw new Error("Identify must be passed a non-empty string or list of aliases, value passed was '"+e+"'");return"string"==typeof e?[{id:e,tag:"default"}]:e},t.prototype.setIdentity=function(e,t,n){void 0===n&&(n=86400),this.identities[e]={value:t,expiry:Date.now()+Math.floor(1e3*n)},this._internals.state.setPermutiveData("identities",this.identities)},t.prototype.getIdentity=function(e){return{defined:e in this.identities,value:e in this.identities?this.identities[e].value:void 0}},t.prototype.getIdentities=function(e){var t=this;return void 0===e&&(e=!1),Object.keys(this.identities).reduce(function(n,r){var i=t.getIdentity(r).value;return void 0!==i&&(e&&!t.getProvider(r).usedForThirdPartyData()||(n[r]=i)),n},{})},t.prototype.hasExpired=function(e){return!(e in this.identities)||Date.now()>=this.identities[e].expiry},t.prototype.registerProvider=function(e){this.providers[e.getTag()]=e},t.prototype.getProvider=function(e){return e in this.providers?this.providers[e]:(this.network.error("Identity provider "+e+" is not registered.",this._internals.state.userId),null)},t.prototype.retrieveIdentity=function(t){var n=this,r=this.getProvider(t);return null===r?e.resolve(void 0):r.getId().then(function(e){var t=void 0===e?"sdk_third_party_identity_missing_count":"sdk_third_party_identity_present_count";return n._internals.metrics.track({name:t,value:1,labels:{identity_tag:r.getTag()}}),n.setIdentity(r.getTag(),e,r.getTtlInSeconds()),e})},t.prototype.retrieveAllIdentities=function(){var t=this,n=this._internals.metrics.startTimer("sdk_get_third_party_identities_task_duration_seconds",{}),r=[],i=function(n){if(!s.providers.hasOwnProperty(n))return"continue";var i=s.getIdentity(n),a=!i.defined||s.hasExpired(n)?s.retrieveIdentity(n):e.resolve(i.value);a.then(function(e){return void 0!==e?t._internals.api.identify([{id:e,tag:n}]):null}),r.push(a)},s=this;for(var a in this.providers)i(a);return e.all(r).then(function(e){return t._internals.metrics.stopTimer("sdk_get_third_party_identities_task_duration_seconds",n),e})},t.prototype.addAlias=function(e,t){this.currentAliases[t]=e},t.prototype.removeAliasByTag=function(e){delete this.currentAliases[e]},t.prototype.storeAliases=function(e){this._internals.state.setPermutiveData("aliases",e)},t.prototype.convertAliases=function(e){var t=this,n={default:0,appnexus:1},r=function(e){return t._internals.identities.getIdentity(e).defined?e in n?n[e]+1:1:0};return Object.keys(e).map(function(t){return{id:e[t],tag:t,priority:r(t)}})},t}();t.PermutiveIdentities=n}).call(this,n(1).Promise)},function(e,t,n){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=n(37);t.providerToIdMap={permutive:"1",eyeota:"2",skimlinks:"4",comscore:"5",eyeota_bombora:"6",eyeota_aimmatic:"7",eyeota_alc:"8",eyeota_amberdata:"9",eyeota_caci:"10",eyeota_corelogic:"11",eyeota_dlg:"12",eyeota_dataxpand:"13",eyeota_dunbradstreet:"14",eyeota_experian:"15",eyeota_gbgtransactis:"16",eyeota_gfk:"17",eyeota_rdaresearch:"18",eyeota_kantarmedia:"19",eyeota_mastercard:"20",eyeota_meritdirect:"21",eyeota_netsprint:"22",eyeota_nri:"23",eyeota_onaudience:"24",eyeota_pacificdatapartners:"25",eyeota_plungedigital:"26",eyeota_roymorgan:"27",eyeota_schober:"28",eyeota_sharethis:"30",eyeota_skimlinks:"31",eyeota_specialists:"32",eyeota_statsocial:"33",eyeota_stirista:"34",eyeota_yougov:"36"};var o=function(){function n(e,t,n){var r=this;this._internals=e,this.permutive=t,this.network=n,this._internals.log("Enabling tpd reporting"),this._internals.messages.on("permutive:segments:updated",function(){r.reportUsage()});var i=this._internals.state.getPermutiveData("third-party-data");this.userSegments=this.isValidState(i)?i:{},this.lastCheckedSession=this._internals.state.getPermutiveData("third-party-data-session-id")||""}return n.prototype.segments=function(){var t=this;if(this.segmentsPromise)return this.segmentsPromise;var n=this._internals.sessionManager.getSessionId();if(this.lastCheckedSession===n)return e.resolve(this.userSegments);var o=s.deferredPromise();this.lastCheckedSession=n;var c=this._internals.metrics.startTimer("sdk_get_third_party_data_task_duration_seconds",{}),u=r({},this._internals.identities.getIdentities(!0),this._internals.identities.currentAliases);if(Object.keys(u).length>0){var l=new a.GraphQLTPD(this._internals.state.userId||s.uuidv4(),this._internals.identities.convertAliases(u));this._internals.graphql.register(l).then(function(e){var n=t.graphQLTPDResponseToSegmentMap(e);t.updateCache(n),o.resolve(n)}).catch(function(e){t.network.error("Third Party Data segments retrieval failed with reason: "+e,t._internals.state.userId),o.resolve({})})}else o.resolve({});var d=this._internals.promises.getPromisesByCategory("tpd"),f=e.all(d.map(function(e){return e.promise})).then(function(e){return o.promise}).then(function(e){return t.userSegments});return f.then(function(e){t._internals.state.setPermutiveData("third-party-data-session-id",n),t._internals.metrics.stopTimer("sdk_get_third_party_data_task_duration_seconds",c);var r=t._internals.state.getPermutiveData("third-party-data");r&&s.nonPrimitiveEq(r,e)||(t._internals.state.setPermutiveData("third-party-data",t.userSegments),Object.entries(e).forEach(function(e){var n=i(e,2),a=n[0],o=n[1];r&&s.nonPrimitiveEq(r[a],o)||t.fireSegments(a,Object.keys(o))}))}),this.segmentsPromise=f,this.segmentsPromise},n.prototype.addSegments=function(e,t){var n;this.updateCache(((n={})[e]=this.listToSegmentMap(t),n))},n.prototype.getActivationMetadata=function(){var e=this._internals.queryManager.getTpdUsage(),n={},i=function(i){if(e.hasOwnProperty(i)){var s=[],a=r({},e[i]);Object.keys(a).forEach(function(e){a[e].forEach(function(n){s.push([i,t.providerToIdMap[e],n].join("-"))})}),n[i]=s}};for(var s in e)i(s);return n},n.prototype.updateCache=function(e){this.userSegments=s.merge(this.userSegments,e)},n.prototype.fireSegments=function(e,t){this.permutive.track("ThirdPartySegments",{data_provider:e,segments:t},{isAnalyticsOnly:!0})},n.prototype.reportUsage=function(){var e=this._internals.queryManager.getTpdUsage(),t=s.hash(JSON.stringify(e));if(this._internals.state.getPermutiveData("third-party-data-usage")!==t&&Object.keys(e).length>0){this._internals.state.setPermutiveData("third-party-data-usage",t);var n={user_id:this._internals.state.userId,time:new Date,tpd_segments:e};this._internals.api.tpdUsage(n)}},n.prototype.graphQLTPDResponseToSegmentMap=function(e){var t=this;return e.identity.tpd.reduce(function(e,n){var i;return r({},e,((i={})[n.name]=t.listToSegmentMap(n.segments),i))},{})},n.prototype.listToSegmentMap=function(e){return e.reduce(function(e,t){return e[t]=!0,e},{})},n.prototype.isValidState=function(e){return e&&void 0===e.expiry_time},n}();t.PermutiveThirdParty=o}).call(this,n(1).Promise)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=["mousemove","click","scroll"],a=["email","tel","submit","reset","button","file","password","radio","checkbox"];t.load=function(e,t){0};var o=function(){function e(e){var t=this;this.dirtyState=!1,this.initialised=!1,this.totalCompletion=0,this.totalEngagedTime=0,this.trackPageviewEngagement=!1,this.trackPageviewEngagementAggregate="boolean"==typeof{auto_init:!1,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!1}.track_aggregate_pageview_engagement&&{auto_init:!1,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!1}.track_aggregate_pageview_engagement,this.trackFormSubmission=!0,this.trackLinkClick=!0,this.aggregateTimeoutDuration=3e5,this.hasAggregateFired=!1,this.permutive=e.permutive,this._internals=e._internals,this.eventInterval=e.eventInterval||5,this.page=e.page||{},this.sendPageviewEvent(),(e.dirtyEvents||s).map(function(e){window.addEventListener(e,function(){t.dirtyState=!0,t.trackPageviewEngagementAggregate&&t.resetTimeout()})}),"loading"!==document.readyState?this.attachListeners():window.addEventListener("DOMContentLoaded",this.attachListeners,!1),this.trackPageviewEngagement&&(this.timerHandle=this.registerEngagementInterval(this.eventInterval)),this.trackPageviewEngagementAggregate&&(this.setAggregateTimeout(this.aggregateTimeoutDuration),i.onPageUnload(function(){return t.hasAggregateFired?null:t.sendAggregateEvent(t.totalEngagedTime,t.totalCompletion)})),this.initialised=!0}return e.prototype.sendPageviewEvent=function(){var e=this,t=r({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"},{},{},this.enrichmentProperties(this.permutive.context.isArticle),this.page?this.page:{}),n={success:function(){e.initialised||e._internals.metrics.trackTimeSinceInit("sdk_first_event_tracked_task_duration_seconds",{})}};this.permutive.track("Pageview",t,n)},e.prototype.sendLinkClickEvent=function(e,t){if(window.location.href&&e.href){var n=0===e.href.indexOf("data:")?"NOT_URL":e.href;this.permutive.track("LinkClick",{dest_url:n},{useBeacon:t})}},e.prototype.sendFormSubmissionEvent=function(e){var t=e.currentTarget,n={form:r({method:t.method||"GET",properties:this.serializeForm(t)},"string"==typeof t.id?{id:t.id}:{},t.name&&"string"==typeof t.name?{name:t.name}:{},t.action&&"string"==typeof t.action?{action:t.action}:{})};this.permutive.track("FormSubmission",n)},e.prototype.sendEngagementEvent=function(e){var t=this.updateState(e),n=t.engaged_time,i=t.total_engaged_time,s=t.completion,a=t.total_completion,o=r({engaged_time:n,total_engaged_time:i},this.page,{completion:s,total_completion:a},{});this.permutive.track("PageviewEngagement",o)},e.prototype.sendAggregateEvent=function(e,t,n){void 0===n&&(n=!0);var i=r({total_engaged_time:e},{total_completion:t});this.permutive.track("PageviewEngagementAggregate",i,{useBeacon:n}),this.hasAggregateFired=!0},e.prototype.reset=function(e){this._internals.state.viewId=i.uuidv4(),this.page=e.page||null,this.totalCompletion=0,this.totalEngagedTime=0,this.sendPageviewEvent(),this.trackPageviewEngagement&&(clearInterval(this.timerHandle),this.timerHandle=this.registerEngagementInterval(this.eventInterval))},e.prototype.serializeForm=function(e){return[].slice.call(e.getElementsByTagName("input"),0).filter(function(e){return!(!e.type||!e.id||e.disabled||e.checked||"fieldset"===e.nodeName.toLowerCase()||-1!==a.indexOf(e.type.toLowerCase()))}).map(function(e){return{name:e.name||e.id,value:e.value}}).filter(function(e){return e.value.length<120})},e.prototype.enrichmentProperties=function(e){return r({},e&&{auto_init:!1,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!1}.add_alchemy_taxonomy?{taxonomy_labels:"$alchemy_taxonomy_labels"}:{},e&&{auto_init:!1,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!1}.add_alchemy_entities?{entity_names:"$alchemy_entity_names"}:{},{})},e.prototype.findParent=function(e,t){if(e.tagName.toLowerCase()===t)return e;for(var n=e.parentElement;null!==n;){if(n.tagName.toLowerCase()===t)return n;n=n.parentElement}return null},e.prototype.registerEngagementInterval=function(e){var t=this;return setInterval(function(){t.dirtyState&&t.sendEngagementEvent(e)},1e3*e)},e.prototype.attachListeners=function(){var e=this;this.trackFormSubmission&&[].slice.call(document.getElementsByTagName("form"),0).forEach(function(t){t.addEventListener("submit",e._internals.makeSafe(e.sendFormSubmissionEvent.bind(e)))}),this.trackLinkClick&&document.body.addEventListener("click",function(t){var n=e.findParent(t.target,"a");if(n){var r=!("_blank"===n.target||t.metaKey||t.ctrlKey||t.shiftKey||2===t.which||3===t.which);e.sendLinkClickEvent(n,r)}})},e.prototype.updateState=function(e){var t=Math.max(this.totalCompletion,this.getCurrentCompletion()),n=t-this.totalCompletion;return this.totalEngagedTime+=e,this.totalCompletion=t,this.dirtyState=!1,{engaged_time:e,total_engaged_time:this.totalEngagedTime,completion:n,total_completion:this.totalCompletion}},e.prototype.getCurrentCompletion=function(){var e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e},e.prototype.setAggregateTimeout=function(e){var t=this;return window.setTimeout(function(){return t.sendAggregateEvent(t.totalEngagedTime,t.totalCompletion,!1)},e)},e.prototype.resetTimeout=function(){clearTimeout(this.aggregateTimeoutHandle),this.aggregateTimeoutHandle=this.setAggregateTimeout(this.aggregateTimeoutDuration)},e}();t.WebAddon=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.load=function(){};var i=function(){function e(e){var t=this;this.permutive=e.permutive,this._internals=e._internals,this.eventInterval=e.eventInterval||5,this.documentId=e.documentId||null,this.article=e.article||null,this.addAlchemyTaxonomy=!0,this.addAlchemyEntities=!1,this.sendPageviewEvent(),this.dirtyState=!1;var n=function(){t.dirtyState=!0};(e.dirtyEvents||["mousemove","click","scroll"]).map(function(e){window.addEventListener(e,n)}),this.totalCompletion=0,this.timerHandle=setInterval(this.sendEngagementEvent(this.eventInterval,this.getCompletion),1e3*this.eventInterval)}return e.prototype.reset=function(e){this._internals.state.viewId=r.uuidv4(),this.documentId=e.documentId||null,this.article=e.article||null,this.totalCompletion=0,clearInterval(this.timerHandle),this.sendPageviewEvent(),this.timerHandle=setInterval(this.sendEngagementEvent(this.eventInterval,this.getCompletion),1e3*this.eventInterval)},e.prototype.sendPageviewEvent=function(){var e,t={isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"};null!==this.documentId&&(t.$document=this.documentId,(this.addAlchemyTaxonomy||this.addAlchemyEntities)&&(e={},this.addAlchemyTaxonomy&&(e.taxonomy_labels="$alchemy_taxonomy_labels"),this.addAlchemyEntities&&(e.entity_names="$alchemy_entity_names"),t.alchemy=e)),null!==this.article&&(t.article=this.article,(this.addAlchemyTaxonomy||this.addAlchemyEntities)&&(e={},this.addAlchemyTaxonomy&&(e.taxonomy_labels="$alchemy_taxonomy_labels"),this.addAlchemyEntities&&(e.entity_names="$alchemy_entity_names"),t.article.alchemy=e)),this.permutive.track("Pageview",t)},e.prototype.getCompletion=function(){var e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e},e.prototype.sendEngagementEvent=function(e,t){var n=this,r=this;return this._internals.makeSafe(function(){if(r.dirtyState){var i={engaged_time:e},s=Math.max(r.totalCompletion,t());i.completion=s-r.totalCompletion,r.totalCompletion=s,r.dirtyState=!1,n.permutive.track("PageviewEngagement",i)}})},e}();t.PublishersAddon=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(e,t){e.q.unshift({functionName:"addon",arguments:["overlays",{}]})};var r=function(){function e(e){var t=this,n=this;this.permutive=e.permutive,this._internals=e._internals,this.reactions=this._internals.state.reactionManager.getReactions("show_overlay"),this.loadedImageCounts={};for(var r=function(e){var r=i.reactions[e],s=r.config,a=i.buildOverlayCss(s,e);document.head.insertAdjacentHTML("beforeend",a);var o=i.buildOverlayBody(s,e);document.body.insertAdjacentHTML("beforeend",o);var c="permutive-overlay-"+e,u=document.getElementById(c),l=u.getElementsByClassName("close")[0],d=u.getElementsByClassName("content")[0],f=function(){u.style.visibility="hidden",u.style.opacity="0"},p=function(e){d.contains(e.target)||(f(),u.removeEventListener("click",p))};l.addEventListener("click",f),u.addEventListener("click",p),[].slice.call(u.getElementsByTagName("a")).slice(1).forEach(function(e){e.addEventListener("click",function(e){r.trackConversion({useBeacon:!0})})});var _=u.getElementsByTagName("form")[0];_&&_.addEventListener("submit",function(e){e.preventDefault(),e.currentTarget,r.trackConversion({success:function(){_.submit()}})});var m=function(e,t){n.showOverlay(e),t.trackImpression()};r.reactEveryTime()?i.permutive.query(r.segmentCode,i._internals.makeSafe(function(e){e.result?m(c,r):t.permutive.trigger(r.segmentCode,"result",function(e){e.result&&m(c,r)})})):r.reactOnEntry()?i.permutive.trigger(r.segmentCode,"result",i._internals.makeSafe(function(e){e.result&&m(c,r)})):r.reactOnExit()&&i.permutive.trigger(r.segmentCode,"result",i._internals.makeSafe(function(e){e.result||m(c,r)}))},i=this,s=0;s<this.reactions.length;s++)r(s)}return e.prototype.buildOverlayCss=function(e,t){return'<style type="text/css">.${overlay_class}{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;background:rgba(0,0,0,0.${opacity_percentage});transition:opacity ${opacity_transition_ms}ms;visibility:hidden;opacity:0;z-index:1000000;}.${modal_class}{position:fixed;padding:10px;background:#fff;border-radius:5px;z-index:1000001}.${modal_class} .content{overflow:auto;z-index:1000002;}.${modal_class} .close{position:absolute;top:20px;right:30px;transition:all 200ms;font-size:30px;font-weight:bold;text-decoration:none;color:#333;z-index:1000003}.${modal_class} .close:hover{color:orange;}</style>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${opacity_percentage}",e.opacity_percentage.toString()).replace("${opacity_transition_ms}",e.opacity_transition_ms.toString())},e.prototype.buildOverlayBody=function(e,t){var n="";return!function(e){return void 0!==e.html}(e)?function(e){return void 0!==e.image_url&&void 0!==e.image_link}(e)&&(n='<a href="'+e.image_link+'"><img src="'+e.image_url+'"/></a>'):n=e.html,'<div id="${overlay_class}" class="${overlay_class}"><div id="${modal_class}" class="${modal_class}"><a class="close" href="javascript:;">&times;</a><div class="content">${content}</div></div></div>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${content}",n).replace(/<img /g,"<img onload='window.permutive.addons.overlays.loadedImage(\"permutive-overlay-"+t+"\")' ")},e.prototype.showOverlay=function(e){var t=this,n=document.getElementById(""+e),r=function(){var e=n.getElementsByTagName("div")[0],t=e.getBoundingClientRect().height,r=e.getBoundingClientRect().width;e.style.left=window.innerWidth/2-r/2+"px",e.style.top=window.innerHeight/2-t/2+"px",n.style.visibility="visible",n.style.opacity="1"},i=n.getElementsByTagName("img");if(i.length>0){var s=0,a=function(){s<10&&(!(e in t.loadedImageCounts)||t.loadedImageCounts[e]<i.length)?(s+=1,setTimeout(a,500)):r()};a()}else r()},e.prototype.loadedImage=function(e){e in this.loadedImageCounts?this.loadedImageCounts[e]=this.loadedImageCounts[e]+1:this.loadedImageCounts[e]=1},e}();t.OverlaysAddon=r},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.load=function(e,t){e.q.unshift({functionName:"addon",arguments:["scriptrunner",{}]})};var ScriptRunnerAddon=function(){function ScriptRunnerAddon(options){var _this=this;this.permutive=options.permutive,this._internals=options._internals,this.network=options.network,this.reactions=this._internals.state.reactionManager.getReactions("run_script");for(var _loop_1=function(i){var reaction=this_1.reactions[i],run_1=function(reaction){var script=reaction.config.script.replace(/impression\(\)/g,"reaction.trackImpression();").replace(/conversion\(\)/g,"reaction.trackConversion();");try{eval(script)}catch(e){e.message="Error running custom script: "+e.message,_this.network.error(e,_this._internals.state.userId)}};reaction.reactEveryTime()?this_1.permutive.query(reaction.segmentCode,function(e){e.result?run_1(reaction):_this.permutive.trigger(reaction.segmentCode,"result",function(e){e.result&&run_1(reaction)})}):reaction.reactOnEntry()?this_1.permutive.trigger(reaction.segmentCode,"result",function(e){e.result&&run_1(reaction)}):reaction.reactOnExit()&&this_1.permutive.trigger(reaction.segmentCode,"result",function(e){e.result||run_1(reaction)})},this_1=this,i=0;i<this.reactions.length;i++)_loop_1(i)}return ScriptRunnerAddon}();exports.ScriptRunnerAddon=ScriptRunnerAddon},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s="_pdfps",a={};t.load=function(e,t){e.q.push({functionName:"addon",arguments:["dfp",{}]}),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){e.ready(t.makeSafe(function(){var e=0;googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().length>0&&googletag.pubads().getSlots().forEach(function(t){t.getResponseInformation()&&e++});var n=0===e?"sdk_targeting_realtime_success_count":"sdk_targeting_realtime_fail_count";t.metrics.track({name:n,value:1,labels:{target:"dfp"}})}),"realtime");var n,o=(n=t.getExternalData(s))?JSON.parse(n):[];googletag.cmd.push(function(){googletag.pubads().setTargeting("permutive",o.map(String))});var c=function(e){for(var t={ad_unit_path:e.getAdUnitPath(),slot_element_id:e.getSlotElementId(),targeting_keys:[]},n={},r=e.getTargetingKeys(),i=0;i<r.length;i++){for(var s=r[i],a=[],o=e.getTargeting(s),c=0;c<o.length;c++)a.push(o[c].toString());a.length>0&&(n[s]=1,t.targeting_keys.push({key:s,value:a}))}var u=googletag.pubads().getTargetingKeys();for(i=0;i<u.length;i++){a=[];if(void 0===n[s=u[i]]){for(o=googletag.pubads().getTargeting(u[i]),c=0;c<o.length;c++)a.push(o[c].toString());a.length>0&&t.targeting_keys.push({key:s,value:a})}}return t},u=function(t){try{var n=!1;window.addEventListener("blur",function(){if(n){var r=a[t];r&&e.track("SlotClicked",r)}}),document.getElementById(t).addEventListener("mouseover",function(){n=!0}),document.getElementById(t).addEventListener("mouseout",function(){n=!1})}catch(e){}};googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().forEach(function(e){var t=e.getResponseInformation();if(t){var n=e.getSlotElementId(),r={advertiser_id:i.numericStringToNumber(t.advertiserId),campaign_id:i.numericStringToNumber(t.campaignId),line_item_id:i.numericStringToNumber(t.lineItemId),creative_id:i.numericStringToNumber(t.creativeId),is_empty:!1,service_name:"publisher_ads",slot:c(e)};a[n]=r,u(n)}}),googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(e){var t=e,n=t.slot.getSlotElementId(),s={advertiser_id:i.numericStringToNumber(t.advertiserId),campaign_id:i.numericStringToNumber(t.campaignId),line_item_id:i.numericStringToNumber(t.lineItemId),creative_id:i.numericStringToNumber(t.creativeId),is_empty:t.isEmpty,service_name:t.serviceName,slot:c(e.slot)};if(t.size){var o=r(t.size),l=o[0],d=o[1];o.slice(2);"number"==typeof l&&"number"==typeof d&&(s.width=l,s.height=d)}a[n]=s,u(n)}),googletag.pubads().addEventListener("impressionViewable",function(t){var n=t.slot.getResponseInformation();n&&e.track("SlotViewable",{advertiser_id:i.numericStringToNumber(n.advertiserId),campaign_id:i.numericStringToNumber(n.campaignId),line_item_id:i.numericStringToNumber(n.lineItemId),creative_id:i.numericStringToNumber(n.creativeId),service_name:t.serviceName,slot:c(t.slot)})})}),window.addEventListener("message",function(t){try{var n=JSON.parse(t.data);if(n.permutive_type&&"google_ad_click"===n.permutive_type){var r=n.data.ad_unit_path,s=i.numericStringToNumber(n.data.creative_id),o=void 0;Object.keys(a).forEach(function(e){void 0!==a[e].slot&&a[e].slot.ad_unit_path===r&&a[e].creative_id===s&&(o=a[e])}),o=o||{line_item_id:i.numericStringToNumber(n.data.line_item_id),advertiser_id:i.numericStringToNumber(n.data.advertiser_id),campaign_id:i.numericStringToNumber(n.data.order_id),creative_id:i.numericStringToNumber(s),is_empty:!1},e.track("SlotClicked",o)}}catch(e){}},!1)})};var o=function(){function e(e){var t=this;this.trackedTargetingLimitMetric=!1,this._internals=e._internals;var n=this._internals.getExternalData(s);this.liveSegments=n?JSON.parse(n):[],this.eligibleSegments={};for(var r=this._internals.state.reactionManager.getSpecializedReactions("target_dfp"),i=0;i<r.dfp.length;i++){var a=r.dfp[i];this.eligibleSegments[a]=a}for(var o in r.dfp_legacy)if(r.dfp_legacy.hasOwnProperty(o)){var c=r.dfp_legacy[o];this.eligibleSegments[o]=c}var u=this._internals.queryManager.userSegments;this.updateSegments(this.filterSegments(u)),this._internals.messages.emit("permutive:dfp:ready"),this._internals.messages.on("permutive:segments:updated",this._internals.makeSafe(function(){var e=t._internals.queryManager.userSegments;t.updateIfNecessary(e)})),this._internals.messages.on("permutive:reset",this._internals.makeSafe(function(){t._internals.removeExternalData(s),t._internals.deleteCookie(s),t.liveSegments=[]}))}return e.prototype.updateIfNecessary=function(e){var t=this.filterSegments(e);this._internals.arraysEqual(t,this.liveSegments)||this.updateSegments(t)},e.prototype.updateSegments=function(e){var t=this.processActivations(this._internals.thirdParty.getActivationMetadata()),n=e.concat(t);encodeURIComponent(JSON.stringify(n)).length>1500&&(n=e,this.trackedTargetingLimitMetric||(this._internals.metrics.track({name:"sdk_targeting_size_limit_exceeded_count",value:1,labels:{target:"dfp"}}),this.trackedTargetingLimitMetric=!0)),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){return googletag.pubads().setTargeting("permutive",n.map(String).concat(["rts"]))});var r=JSON.stringify(n.map(String));this._internals.setExternalData(s,r),"boolean"==typeof{auto_init:!0,networks:[{name:"default",network_code:"5441"}],track_slot_clicked:!0,track_slot_rendered:!1,track_slot_viewable:!0}.sync_segments_cookie&&{auto_init:!0,networks:[{name:"default",network_code:"5441"}],track_slot_clicked:!0,track_slot_rendered:!1,track_slot_viewable:!0}.sync_segments_cookie&&this._internals.api.segmentSync(s,r),this.liveSegments=e},e.prototype.filterSegments=function(e){var t=this;return e.filter(function(e){return e in t.eligibleSegments}).map(function(e){return t.eligibleSegments[e]})},e.prototype.processActivations=function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)&&n in this.eligibleSegments)for(var r=0;r<e[n].length;r++)t.push(e[n][r]);return t},e}();t.DFPAddon=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="addon:tradedesk",i=86400;t.load=function(e,t){var n={overlays:{auto_init:!0},dbm:{auto_init:!0,entity_id:2024,product_type:"INVITE_PARTNER"},web:{auto_init:!1,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!1},scriptrunner:{auto_init:!0},publishers:{add_alchemy_entities:!1,add_alchemy_taxonomy:!0,auto_init:!1},tradedesk:{advertiser_id:"1rjrst3",auto_init:!0},dfp:{auto_init:!0,networks:[{name:"default",network_code:"5441"}],track_slot_clicked:!0,track_slot_rendered:!1,track_slot_viewable:!0}};(n.tradedesk&&n.tradedesk.auto_init||n.thirdparty_tradedesk&&n.thirdparty_tradedesk.auto_init)&&e.q.push({functionName:"addon",arguments:["tradedesk",{}]})};var s=function(){function e(e){this.permutive=e.permutive,this._internals=e._internals;var t=this._internals.state.getPermutiveData(r);(isNaN(t)||(new Date).getTime()>t+1e3*i)&&this.initiateIdSync()}return e.prototype.initiateIdSync=function(){var e=("https:"===location.protocol?"https:":"http:")+"//match.adsrvr.org/track/cmf/generic?ttd_pid=dbegppc&ttd_tpi=1&ttd_puid="+this._internals.config.apiKey+","+this._internals.state.userId;(new Image).src=e,this._internals.state.setPermutiveData(r,(new Date).getTime())},e}();t.TradeDeskAddon=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="addon:ddp",i=86400;t.load=function(e,t,n){};var s=function(){function e(e){this.permutive=e.permutive,this._internals=e._internals;var t=this._internals.state.getPermutiveData(r);(isNaN(t)||(new Date).getTime()>t+1e3*i)&&this.initiateIdSync()}return e.prototype.initiateIdSync=function(){var e="https://cm.g.doubleclick.net/pixel?google_nid=permutive_dmp&google_cm&type=ddp&k="+this._internals.config.apiKey+"&u="+this._internals.state.userId;(new Image).src=e,this._internals.state.setPermutiveData(r,(new Date).getTime())},e}();t.DDPAddon=s},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){};t.SingleEnricher=s;var a=function(){function e(){this.replacementMap={}}return e.prototype.register=function(e){this.replacementMap=r({},this.replacementMap,e.replacementMap)},e.prototype.enrich=function(e){for(var t=[{},!0],n=0;n<Object.keys(e[0]).length;n++){var r=Object.keys(e[0])[n],s=e[0][r];switch(!0){case"string"==typeof s&&"$"===s[0]:var a=i(this.isPropertyReplaceable(s),2),o=a[0],c=a[1];t[0][r]=o?c:s,t[1]=!!o&&t[1];break;case null!==s&&"object"==typeof s&&s.constructor===Object:var u=this.enrich([s,t[1]]);t[0][r]=u[0],t[1]=t[1]&&u[1];break;default:t[0][r]=s}}return t},e.prototype.isPropertyReplaceable=function(e){var t=this.replacementMap[e];return[this.replacementMap.hasOwnProperty(e)&&t!==e,t]},e}();t.GlobalEnricher=a},function(module,exports,__webpack_require__){"use strict";(function(Promise){var __read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},__spread=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e};Object.defineProperty(exports,"__esModule",{value:!0});var PermutiveNetwork_1=__webpack_require__(26),PermutiveState_1=__webpack_require__(27),PermutiveUtils_1=__webpack_require__(0),PermutiveIdentities_1=__webpack_require__(7),PermutiveInternals_1=__webpack_require__(32),PermutivePromises_1=__webpack_require__(33),SessionManager_1=__webpack_require__(34),PermutiveMetrics_1=__webpack_require__(35),PermutiveApi_1=__webpack_require__(36),PermutiveThirdParty_1=__webpack_require__(8),PermutiveEventHandler_1=__webpack_require__(38),PermutiveMethods_1=__webpack_require__(39),Enricher_1=__webpack_require__(16),GraphQLQuery_1=__webpack_require__(41),GraphQLIdentify_1=__webpack_require__(42),GraphQLEvents_1=__webpack_require__(43),events_1=__webpack_require__(44),Config_1=__webpack_require__(45),PermutiveEventsBatch_1=__webpack_require__(46),QueryManager_1=__webpack_require__(47);!function(){var wwSupport=!!window.Worker&&!!window.Blob,mod="modernizr",lsSupport=!0,lsQuotaExceeded=!1;try{localStorage.setItem(mod,mod),localStorage.removeItem(mod)}catch(e){"QuotaExceededError"===e.name||"QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||window.localStorage&&0===window.localStorage.remainingSpace?lsQuotaExceeded=!0:lsSupport=!1}if(wwSupport&&lsSupport){var sdkInitTimestamp=void 0;void 0!==window.performance&&void 0!==window.performance.now&&(sdkInitTimestamp=performance.now());var permutive=window.permutive;Config_1.buildConfig(permutive);var permutiveNetwork=new PermutiveNetwork_1.PermutiveNetwork(permutive.config),_internals=new PermutiveInternals_1.PermutiveInternals(permutive.config,permutive,permutiveNetwork),initialised=!1,handleConsent=function(e){return"object"==typeof e&&(localStorage.setItem("permutive-consent",JSON.stringify(e)),e.opt_in&&null!==e.token&&e.token.length>0)};permutive.consent=function(e){handleConsent(e)&&!initialised&&(initialiseSDK(),initialised=!0)};for(var i=0;i<permutive.q.length;i++){var funcCall=permutive.q[i];if("consent"===funcCall.functionName){var consentData=funcCall.arguments[0];handleConsent(consentData)&&!initialised&&(initialiseSDK(),initialised=!0)}}if(permutive.q=permutive.q.filter(function(e){return"consent"!==e.functionName}),!initialised){var cachedConsentData=JSON.parse(localStorage.getItem("permutive-consent")),optIn=cachedConsentData?cachedConsentData.opt_in:void 0;permutive.config.consentRequired&&optIn?initialiseSDK():permutive.config.consentRequired||!1===optIn||initialiseSDK()}}function initialiseSDK(){_internals.addons={},_internals.promises=new PermutivePromises_1.PermutivePromises,_internals.messages=new events_1.Events,permutive.addons=_internals.addons;try{_internals.eventsBatch=new PermutiveEventsBatch_1.PermutiveEventsBatch(_internals,permutiveNetwork),_internals.sessionManager=new SessionManager_1.SessionManager(_internals),_internals.state=new PermutiveState_1.PermutiveState(_internals,permutive,permutiveNetwork),_internals.queryManager=new QueryManager_1.QueryManager(_internals,permutive,permutiveNetwork);var isMetricsUser=_internals.state.getPermutiveData("metricsEnabled");switch(isMetricsUser){case!0:_internals.metrics=new PermutiveMetrics_1.PermutiveMetrics(sdkInitTimestamp,_internals,permutive);break;case!1:_internals.metrics=new PermutiveMetrics_1.PermutiveMetricsNoOp;break;case void 0:var metricsEnabled=void 0!==sdkInitTimestamp&&Math.random()<=_internals.config.metricsSamplingPercentage/100;_internals.metrics=metricsEnabled?new PermutiveMetrics_1.PermutiveMetrics(sdkInitTimestamp,_internals,permutive):new PermutiveMetrics_1.PermutiveMetricsNoOp,_internals.state.setPermutiveData("metricsEnabled",metricsEnabled)}var eventCache_1=_internals.state.eventsCache.load();Promise.resolve().then(function(){return __webpack_require__(49)}).then(function(e){return _internals.models=new e.PermutiveModels(_internals,permutiveNetwork)}),_internals.api=new PermutiveApi_1.PermutiveApi(_internals,permutiveNetwork),_internals.eventHandler=new PermutiveEventHandler_1.EventHandler;var permutiveMethods_1=new PermutiveMethods_1.PermutiveMethods(_internals,permutive,permutiveNetwork);_internals.identities=new PermutiveIdentities_1.PermutiveIdentities(_internals,permutiveNetwork),_internals.thirdParty=new PermutiveThirdParty_1.PermutiveThirdParty(_internals,permutive,permutiveNetwork),permutive.context=permutive.context||{},permutive.context.path=window.location.pathname,permutive.context.url=window.location.href,permutive.context.referrer=document.referrer,_internals.blockers=[],_internals.addBlocker("permutive:queries:initialised"),_internals.enrichers=new Enricher_1.GlobalEnricher,_internals.graphql=new GraphQLQuery_1.GraphQLQuery(_internals);for(var scripts=[],i=0;i<scripts.length;i++){var script=scripts[i];try{eval(script)}catch(e){e.message="Error running custom script ["+i+"]"+e.message,permutiveNetwork.error(e,_internals.state.userId)}}_internals.messages.on("permutive:blockers:empty",function(){PermutiveUtils_1.extend(permutive,permutiveMethods_1),permutive.config.exposeInternals&&PermutiveUtils_1.extend(permutive,_internals),_internals.setAsReady(),_internals.applyQueue(),delete permutive.q});var retrieveThirdPartyIdentities_1=function(){return _internals.identities.retrieveAllIdentities()},resolveIdentity_1=function(){var e=PermutiveUtils_1.deferredPromise();_internals.log("<call> init identity "),permutive.context.user_id=_internals.state.userId,permutive.q.filter(function(e){return"identify"===e.functionName}).forEach(function(e){_internals.makeSafe(function(){var t=PermutiveIdentities_1.PermutiveIdentities.getAliasesFromIdentifyArg(e.arguments[0]);_internals.api.identify(t)})()}),permutive.q=permutive.q.filter(function(e){return"identify"!==e.functionName});var t=_internals.identities.currentAliases;_internals.log("Starting identification... Current aliases are:",t);var n=_internals.state.userId,r=new GraphQLIdentify_1.GraphQLIdentify(n,_internals.identities.convertAliases(t));return _internals.graphql.register(r).then(function(r){return i={user_id:r.identity.identify.id},s=i.user_id,a=!1,s!==n&&(_internals.log("Got different user id from API: "+s),_internals.state.reset(),_internals.state.setUserId(s),a=!0),_internals.identities.storeAliases(t),void e.resolve({identityChanged:a,userId:s});var i,s,a}).catch(function(){permutiveNetwork.error("Couldn't set identity for user "+n,n),e.resolve({identityChanged:!1,userId:n})}),e.promise.then(function(e){_internals.messages.emit("permutive:user:ready"),_internals.setIdentityReady(),_internals.log("<done> init identity ",e)}),e.promise},onIdentityChanged_1=function(){_internals.log("Identity has changed");var e=_internals.state.eventsCache.refresh({from:new Date(0)});return _internals.state.eventsCache.setReady(),e.then(function(e){var t=_internals.state.eventsCache.processRefreshEvents(e,{write:!0});return _internals.log("Retrieved full event history from API"),_internals.queryManager.updateSegmentResults(t),_internals.queryManager.initWorker(t)})},onIdentityRemained_1=function(e){return _internals.log("Identity hasn't changed"),eventCache_1.then(function(e){_internals.log("Loaded local event cache");var t=_internals.state.eventsCache.processCachedEvents(e);return _internals.state.eventsCache.setReady(),_internals.queryManager.initWorker(t)}).then(function(){return e}).then(function(e){var t=_internals.state.eventsCache.processRefreshEvents(e,{write:!0});return _internals.log("Updating query states with unseen events from API (#e)",t.length),_internals.queryManager.updateWithHistoricSegments(t)})},loadAddon_1=function(e){return e.load(permutive,_internals,permutiveNetwork)},addons=__spread([],[],[],[],[],[],[Promise.resolve().then(function(){return __webpack_require__(50)})],[Promise.resolve().then(function(){return __webpack_require__(15)})],[Promise.resolve().then(function(){return __webpack_require__(13)})],[],[],[],[],[],[],[],[],[Promise.resolve().then(function(){return __webpack_require__(11)})],[],[],[],[Promise.resolve().then(function(){return __webpack_require__(10)})],[],[],[],[Promise.resolve().then(function(){return __webpack_require__(12)})],[],[],[Promise.resolve().then(function(){return __webpack_require__(14)})],[],[Promise.resolve().then(function(){return __webpack_require__(9)})]);addons.forEach(function(e){return e.then(loadAddon_1)});var registerEnricher_1=function(e){return e.register(_internals,permutive)},enrichers=__spread([Promise.resolve().then(function(){return __webpack_require__(51)})],[]);enrichers.forEach(function(e){return e.then(registerEnricher_1)});var registerIdentityPovider_1=function(e){return e.register(_internals,permutiveNetwork)},identityProviders=__spread([],[Promise.resolve().then(function(){return __webpack_require__(52)})],[]);Promise.all(identityProviders).then(function(e){return e.forEach(registerIdentityPovider_1)}).then(function(e){return retrieveThirdPartyIdentities_1()}).then(function(){_internals.thirdParty.segments();var e=resolveIdentity_1(),t=_internals.state.eventsCache.getRefreshFromTime(),n=_internals.graphql.register(new GraphQLEvents_1.GraphQLEvents(_internals.state.userId,t));return _internals.graphql.run(),e.then(function(e){return e.identityChanged?onIdentityChanged_1():(_internals.state.eventsCache.lastRefreshed=t,_internals.state.eventsCache.storeLastRefreshTime(),onIdentityRemained_1(n.then(function(e){return e.events}).catch(function(e){return permutiveNetwork.error("Identity retrieval failed with reason: "+e,_internals.state.userId),e})))})}).then(function(){return Promise.all([_internals.thirdParty.segments(),_internals.models.getModels()]).then(function(e){return _internals.log("Loaded TPD segments and lookalike models",e),_internals.queryManager.updateEnvironment({segments:PermutiveUtils_1.merge({"1p":_internals.queryManager.userSegmentsDict},e[0]),lookalikeModels:e[1]})})}).then(function(){_internals.queryManager.setAsReady(),_internals.messages.emit("permutive:api:ready"),_internals.metrics.track({name:"sdk_local_storage_byte_total",value:_internals.state.getStateSizeInBytes(),labels:{}}),_internals.metrics.track({name:"sdk_query_states_byte_total",value:_internals.queryManager.getStateSizeInBytes(),labels:{}})})}catch(e){permutiveNetwork.error(e,_internals.state?_internals.state.userId:null)}lsQuotaExceeded&&permutiveNetwork.error("Local storage quota exceeded prior to initialisation")}}()}).call(this,__webpack_require__(1).Promise)},function(e,t,n){"use strict";t.cast=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})}},function(e,t,n){"use strict";var r=n(2).isArray,i=n(2).isFunction;t.all=function(e){if(!r(e))throw new TypeError("You must pass an array to all.");return new this(function(t,n){var r,s=[],a=e.length;function o(e){return function(t){c(e,t)}}function c(e,n){s[e]=n,0==--a&&t(s)}0===a&&t([]);for(var u=0;u<e.length;u++)(r=e[u])&&i(r.then)?r.then(o(u),n):c(u,r)})}},function(e,t,n){"use strict";var r=n(2).isArray;t.race=function(e){if(!r(e))throw new TypeError("You must pass an array to race.");return new this(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})}},function(e,t,n){"use strict";t.resolve=function(e){return new this(function(t,n){t(e)})}},function(e,t,n){"use strict";t.reject=function(e){return new this(function(t,n){n(e)})}},function(e,t,n){"use strict";(function(e,n){var r="undefined"!=typeof window?window:{},i=r.MutationObserver||r.WebKitMutationObserver,s=void 0!==e?e:void 0===this?window:this;var a,o,c,u,l=[];function d(){for(var e=0;e<l.length;e++){var t=l[e];(0,t[0])(t[1])}l=[]}void 0!==n&&"[object process]"==={}.toString.call(n)?a=function(){n.nextTick(d)}:i?(o=0,c=new i(d),u=document.createTextNode(""),c.observe(u,{characterData:!0}),a=function(){u.data=o=++o%2}):a=function(){s.setTimeout(d,1)},t.asap=function(e,t){1===l.push([e,t])&&a()}}).call(this,n(6),n(24))},function(e,t){var n,r,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var e=o(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new _(e,t)),1!==u.length||l||o(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){var r=n(4).Promise,i=n(2).isFunction;t.polyfill=function(){var t,n;"Promise"in(t=void 0!==e?e:"undefined"!=typeof window&&window.document?window:self)&&"cast"in t.Promise&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&(new t.Promise(function(e){n=e}),i(n))||(t.Promise=r)}}).call(this,n(6))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(e){this.config=e,this.clientErrorsSent=0}return t.prototype.getEndpointUrl=function(e){return this.config.apiProtocol+"://"+this.config.apiHost+"/"+this.config.apiVersion+e},t.prototype.req=function(t,n){var r=-1===t.url.indexOf("?")?"?":"&",i=""+t.url+r+"k="+this.config.apiKey,s=t.method||"GET",a=t.data?JSON.stringify(t.data):"",o=t.contentType?t.contentType:"application/json";if(n&&navigator.sendBeacon){if(navigator.sendBeacon(i,a))return t.success&&t.success(a),e.resolve();var c="Failed to queue beacon";return t.error&&t.error(c),e.reject(c)}return this.ajax({type:s,url:i,contentType:o,dataType:t.dataType?t.dataType:"json",data:a,timeout:this.config.timeout,xhrFields:t.xhrFields}).then(function(e){return t.success&&t.success(e),e},function(e){return t.error&&t.error(e),null})},t.prototype.ajax=function(t){var n=this;return new e(function(e,r){var i={},s=t.dataType?t.dataType:"json",a=new XMLHttpRequest;if(t.contentType&&function(e,t){i[e.toLowerCase()]=[e,t]}("Content-Type",t.contentType),"binary"===t.dataType&&(a.responseType="arraybuffer"),a.onload=function(){404===this.status?r("Resource not found"):e("json"===s?this.responseText?JSON.parse(this.responseText):null:"text"===s?this.responseText:this.response)},a.onerror=function(){n.error("Failed AJAX request"),r(new TypeError("Network request failed"))},a.ontimeout=function(){n.error("AJAX request timed out"),r(new TypeError("Network request timed out"))},a.open(t.type?t.type:"GET",t.url,!0),t.timeout&&(a.timeout=t.timeout),t.xhrFields)for(var o in t.xhrFields)a[o]=t.xhrFields[o];Object.keys(i).forEach(function(e){var t=i[e];a.setRequestHeader(t[0],t[1])}),a.send(t.data?t.data:null)})},t.prototype.error=function(e,t){if(this.config.sendClientErrors){if(this.clientErrorsSent>3)return;this.clientErrorsSent+=1;var n={user_id:t||"",domain:window.location.hostname?window.location.hostname:"",url:window.location.href?window.location.href:"",referrer:document.referrer?document.referrer:"",user_agent:navigator.userAgent?navigator.userAgent:"",error_message:"",stack_trace:"",additional_details:""};e instanceof Error?(void 0!==e.message&&(n.error_message=e.message.toString()),void 0!==e.stack&&(n.stack_trace=e.stack.toString())):n.additional_details=e.toString(),this.req({url:this.getEndpointUrl("/internal/errors"),method:"POST",data:n,contentType:"text/plain",dataType:"text"},!1)}else window.console&&(window.console.error?window.console.error("[Permutive]",e):window.console.log&&window.console.log("[Permutive]",e))},t}();t.PermutiveNetwork=n}).call(this,n(1).Promise)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(30),s=n(31),a=n(0),o=function(){function e(e,t,n){this._internals=e,this.permutive=t,this.network=n,this.taskQueue=new s.PermutiveTaskQueue(this._internals);var o=this._internals.getNamespacedStorageKey(t.config.permutiveDataKey),c=localStorage.getItem(o);if(this.permutiveDataByteSize=null===c?0:2*c.length,this.permutiveData=null===c?{}:JSON.parse(c),this.userId=this.getUserId(),this.userId)this.setUserId(this.userId);else{var u=a.uuidv4();this._internals.log("Stored user id is null, creating new id: "+u),this.setUserId(u)}this.viewId=a.uuidv4(),this.eventsCache=new i.PermutiveEventsCache(this,this._internals),this.reactionManager=new r.PermutiveReactionManager(this,this._internals,this.permutive),this.reactionManager.load()}return e.prototype.reset=function(){this._internals.log("Resetting SDK"),this.eventsCache.reset(),this._internals.deleteCookie(this.permutive.config.cookieName),this._internals.removeExternalData(this.permutive.config.cookieName),this.permutiveData={},this.permutiveDataByteSize=0,localStorage.removeItem(this.permutive.config.permutiveDataKey)},e.prototype.getUserId=function(){var e=this._internals.getCookie(this.permutive.config.cookieName);return e||this._internals.getExternalData(this.permutive.config.cookieName)},e.prototype.setUserId=function(e){this._internals.setCookie(this.permutive.config.cookieName,e,!0),this._internals.setExternalData(this.permutive.config.cookieName,e),this.userId=e},e.prototype.getPermutiveData=function(e){return this.permutiveData[e]},e.prototype.setPermutiveData=function(e,t){this.permutiveData[e]=t;var n=this._internals.getNamespacedStorageKey(this.permutive.config.permutiveDataKey),r=JSON.stringify(this.permutiveData);this.permutiveDataByteSize=2*r.length,this._internals.makeSafe(function(){localStorage.setItem(n,r)})()},e.prototype.getPageviewId=function(){return this.getViewId()},e.prototype.getViewId=function(){return this.viewId},e.prototype.getClient=function(){var e="";return e=document.title?document.title:"",{type:"web",user_agent:navigator.userAgent?navigator.userAgent:"",url:window.location.href?window.location.href:"",domain:window.location.hostname?window.location.hostname:"",title:e,referrer:document.referrer?document.referrer:""}},e.prototype.getStateSizeInBytes=function(){return this.permutiveDataByteSize+this.eventsCache.getStateSizeInBytes()},e}();t.PermutiveState=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(29),s=function(){function e(e,t,n){this.state=e,this._internals=t,this.permutive=n,this.reactionsConfig=[{id:"5a611f0b-bec7-4424-9600-80c498e5e5ad",reaction_type:"tradedesk",trigger_type:"EveryTime",variants:[{config:{},id:"c859962c-1a3a-4b6d-b6b8-19a2d57fb01e",start_bucket:0,segment_code:31234}]},{id:"dfd97231-8899-4492-ad1e-4ac365133f96",reaction_type:"tradedesk",trigger_type:"EveryTime",variants:[{config:{},id:"0acd8777-7c56-4f56-ac30-5c027fe0b514",start_bucket:0,segment_code:32378}]},{id:"7bc66657-efd9-49d9-ad73-c9d151a22b8c",reaction_type:"tradedesk",trigger_type:"EveryTime",variants:[{config:{},id:"8526e4d6-1fc1-48c0-830d-2dbaf32c053a",start_bucket:0,segment_code:32377}]},{id:"92df4229-cc78-447f-97e9-f4676d1303f9",reaction_type:"tradedesk",trigger_type:"EveryTime",variants:[{config:{},id:"4e9f3242-4e8f-484e-a0c1-187d247ac0b5",start_bucket:0,segment_code:32281}]}],this.specializedReactionsConfig={target_dfp:{dfp:[29010,31591,31590,28692,28697,31787,30401,29745,32754,32755,28686,31281,28695,30815,30817,30123,28693,30810,31638,30811,28680,28679,28687,31639,28682,29578,28681,31389,27545,28696,28691,30816,29093,29102,31075,30809,30109,30813,31381,32750,27178,32752,28685,27550,32865,31637,30814,32281,30812,30808,31382,29831,26604,29220,32756,30820,30106,29605,32751,31390,29720,28211,31391,29606,28684,29580,28690,28694,30821,30400,26399,28688,27549],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{},appnexus_adserver:[],nativo:[]},this.reactions={}}return e.prototype.load=function(){for(var e=0;e<this.reactionsConfig.length;e++){var t=this.reactionsConfig[e];this.reactions[t.reaction_type]?this.reactions[t.reaction_type].push(t):this.reactions[t.reaction_type]=[t]}},e.prototype.evaluateContextCriteria=function(e){for(var t=this,n=function(e){var n=t.permutive.context[e.key];return void 0!==n&&("EQUALS"===e.comparison?n===e.value:"NOT_EQUALS"===e.comparison?n!==e.value:"CONTAINS"===e.comparison?n.indexOf(e.value)>=0:"NOT_CONTAINS"===e.comparison&&n.indexOf(e.value)<0)},r=0;r<e.criteria.length;r++){var i=n(e.criteria[r]);if("AND"===e.operator&&!i)return!1;if("OR"===e.operator&&i)return!0}return"AND"===e.operator},e.prototype.selectVariant=function(e,t){if(1===t.length)return t[0];var n=this.state.userId+e,i=Math.abs(r.hash(n))%12e4;t.sort(function(e,t){return e.start_bucket-t.start_bucket});var s=r.findIndex(t,function(e){return i<e.start_bucket});return t[s>=0?s-1:t.length-1]},e.prototype.getSpecializedReactions=function(e){return this.specializedReactionsConfig[e]},e.prototype.getReactions=function(e){var t=[];if(this.reactions[e])for(var n=0;n<this.reactions[e].length;n++){var r=this.reactions[e][n],s=this.selectVariant(r.id,r.variants);if(s){var a=s.context_criteria;a&&!this.evaluateContextCriteria(a)||t.push(new i.PermutiveReaction(this.permutive,this._internals,r.id,s.segment_code,"",r.reaction_type,r.trigger_type,s.id,s.config))}}return t},e}();t.PermutiveReactionManager=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i,s,a,o,c){this.permutive=e,this._internals=t,this.id=n,this.segmentCode=r,this.segmentName=i,this.reactionType=s,this.triggerType=a,this.variantId=o,this.config=c}return e.prototype.reactEveryTime=function(){return"EveryTime"===this.triggerType},e.prototype.reactOnEntry=function(){return"OnEntry"===this.triggerType},e.prototype.reactOnExit=function(){return"OnExit"===this.triggerType},e.prototype.trackImpression=function(e){var t={reaction_id:this.id,variant_id:this.variantId,type:"impression"};this.permutive.track("Reaction",t,e),this._internals.log("impression: ",t)},e.prototype.trackConversion=function(e){var t={reaction_id:this.id,variant_id:this.variantId,type:"conversion"};this.permutive.track("Reaction",t,e),this._internals.log("conversion: ",t)},e}();t.PermutiveReaction=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(3),s=function(){function e(e,t){this.state=e,this._internals=t,this.initialised=!1,this.hasAttemptedSizeReduction=!1,this.lastRefreshed=null,this.eventObjectCache=[],this.eventCacheSizeInBytes=0,this.retrieveLastRefreshTime()}return e.prototype.all=function(){return this.eventObjectCache},e.prototype.setReady=function(){this.initialised=!0},e.prototype.add=function(e,t){void 0===t&&(t={shouldWrite:!0});for(var n=!1,r=0;r<this.eventObjectCache.length;r++)if(this.eventObjectCache[r].id===e.id){n=!0;break}return n?e=void 0:(this.eventObjectCache.push(e),t.shouldWrite&&this.write()),e},e.prototype.processCachedEvents=function(e){for(var t=[],n=0;n<e.length;n++){var r=i.deserializeEvent(e[n]);t.push(r),this.add(r,{shouldWrite:!1})}return t},e.prototype.load=function(){var e=this,t=r.deferredPromise(),n=this._internals.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{}),i=this._internals.getExternalData("permutive-events-cache"),s=[];try{s=i?JSON.parse(i):[]}catch(e){}return this.eventCacheSizeInBytes=i?2*i.length:0,this._internals.metrics.track({name:"sdk_events_cache_byte_total",value:this.eventCacheSizeInBytes,labels:{}}),this._internals.metrics.track({name:"sdk_events_cache_size_total",value:s.length,labels:{}}),t.resolve(s),t.promise.then(function(){e._internals.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",n)}),t.promise},e.prototype.refresh=function(e){return void 0===e&&(e={processImmediately:!1}),e.from||(e.from=this.getRefreshFromTime(),this.lastRefreshed=e.from,this.storeLastRefreshTime()),this._internals.log("refreshing from: ",e.from),this._internals.api.events(this._internals.state.userId,{error:e.error,from:e.from})},e.prototype.processRefreshEvents=function(e,t){void 0===t&&(t={});for(var n=[],r=e||[],s=0;s<r.length;s++){var a=this.add(i.deserializeEvent(r[s]),{shouldWrite:!1});a&&n.push(a)}if(r.length>0){var o=new Date(r[r.length-1].time);o.setMilliseconds(o.getMilliseconds()+1),this.lastRefreshed=o,this.storeLastRefreshTime()}return this._internals.log("events from api: ",r),this._internals.log("new events from api: ",n),this._internals.log("events cache",this.eventObjectCache),n.length>0&&t.write&&this.write(),n},e.prototype.reset=function(){this._internals.removeExternalData("permutive-events-cache"),this.eventObjectCache=[],this.eventCacheSizeInBytes=0,this.lastRefreshed=null},e.prototype.write=function(e){void 0===e&&(e=this.eventObjectCache);for(var t=JSON.stringify(e),n=1;e.length>0&&t.length>this._internals.config.eventsCacheLimitBytes/2;)e.splice(0,n),n*=2,t=JSON.stringify(e);this._internals.log("Writing cache (#e)",e.length),this._internals.setExternalData("permutive-events-cache",t),this.eventCacheSizeInBytes=2*t.length},e.prototype.setRefreshFromTime=function(e){this.lastRefreshed=e,this.storeLastRefreshTime()},e.prototype.getRefreshFromTime=function(){var e=this.lastRefreshed;return e||(e=this._internals.utcNow()),e&&e.setMilliseconds(e.getMilliseconds()+1),e},e.prototype.storeLastRefreshTime=function(){this.state.setPermutiveData("last_refresh_time",this.lastRefreshed.toISOString())},e.prototype.getStateSizeInBytes=function(){return this.eventCacheSizeInBytes},e.prototype.retrieveLastRefreshTime=function(){var e=this.state.getPermutiveData("last_refresh_time")||null;e&&(this.lastRefreshed=new Date(e))},e}();t.PermutiveEventsCache=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=this;this._internals=e,this.queue=[],this.nextNotify=null,e.messages.on("permutive:taskQueue:update",function(){t.execute()})}return e.prototype.add=function(e){this.queue.push(e),this.notify()},e.prototype.notify=function(){var e=this,t=function(){e._internals.messages.emit("permutive:taskQueue:update")},n=(new Date).getTime();null===this.nextNotify||this.nextNotify<n-50?(this.nextNotify=n,t()):this.nextNotify<=n&&(this.nextNotify=n+50,window.setTimeout(t,50))},e.prototype.execute=function(){var e=this;if(0!==this.queue.length){for(var t=!1,n=!1,r=0,i=0;i<this.queue.length;i++){var s=this.queue[i];if(s.complete)r+=1;else if(s.started)n=!0,t=t||s.blocks();else{if(s.waits()&&n)break;t||(n=!0,t=t||s.blocks(),s.execute(function(){e.notify()}))}}this.queue.splice(0,r)}},e.prototype.size=function(){return this.queue.length},e}();t.PermutiveTaskQueue=r},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,n){this.config=e,this.permutive=t,this.network=n,this.isReady=!1,this.isRealtime=!1,this.isIdentityReady=!1,this.listenForBlockers=!0}return e.prototype.makeSafe=function(e){var t=this;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return e.apply(void 0,i(n))}catch(e){t.network.error(e,t.state.userId)}}},e.prototype.utcNow=function(){var e=new Date;return new Date(e.toUTCString())},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.config.loggingEnabled&&window.console&&window.console.log&&(e.splice(0,0,"[Permutive]"),console.log.apply(console,e))},e.prototype.applyQueue=function(){var e=this,t=["identify","trigger","addon","track"];i(this.permutive.q).sort(function(e,n){var r=t.indexOf(e.functionName),i=t.indexOf(n.functionName);return-1===r?-1===i?0:1:-1===i?-1:r-i}).forEach(function(t){t.functionName in e.permutive?e.permutive[t.functionName].apply(e.permutive,t.arguments):e.network.error('Function "permutive.'+t.functionName+'" does not exist.',e.state.userId)})},e.prototype.setAsReady=function(){this.isReady=!0,this.metrics.trackTimeSinceInit("sdk_initialisation_task_duration_seconds",{sdk_version:"v9.9.1"}),window.performance&&window.performance.memory&&(this.metrics.track({name:"sdk_heap_memory_bytes_used",value:window.performance.memory.usedJSHeapSize,labels:{}}),this.metrics.track({name:"sdk_heap_memory_limit_fraction_used",value:window.performance.memory.usedJSHeapSize/window.performance.memory.jsHeapSizeLimit,labels:{}})),this.messages.emit("permutive:ready")},e.prototype.setAsRealtime=function(){this.isRealtime=!0,this.metrics.trackTimeSinceInit("sdk_realtime_targeting_set_task_duration_seconds",{})},e.prototype.setIdentityReady=function(){this.isIdentityReady=!0},e.prototype.addBlocker=function(e){var t=this;this.blockers.push(e),this.log("<blockers> added blocker "+e),this.messages.on(e,function(){if(t.listenForBlockers){var n=t.blockers.indexOf(e);n>=0&&(t.blockers.splice(n,1),t.log("<blockers> removed blocker "+e)),0===t.blockers.length&&(t.listenForBlockers=!1,t.messages.emit("permutive:blockers:empty"),t.log("<blockers> complete"))}})},e.prototype.getNamespacedStorageKey=function(e){return""+this.permutive.config.stateNamespace+e},e.prototype.setCookie=function(e,t,n){if(void 0===n&&(n=!1),!(t&&e&&this.config.cookieExpiry&&this.config.cookieDomain))return!1;var r=this.getNamespacedStorageKey(e);document.cookie=[encodeURIComponent(r),"=",encodeURIComponent(t),"; expires=",this.config.cookieExpiry,"; domain=",this.config.cookieDomain,"; path=/",n?"; samesite=none; secure":""].join("")},e.prototype.getCookie=function(e,t){void 0===t&&(t=!1);var n=t?e:this.getNamespacedStorageKey(e),r=new RegExp(encodeURIComponent(n)+"=([^;]+)").exec(document.cookie);return null!==r?decodeURIComponent(r[1]):null},e.prototype.deleteCookie=function(e){if(!e||!this.config.cookieDomain)return!1;var t=this.getNamespacedStorageKey(e);return document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain="+this.config.cookieDomain+"; path=/",!0},e.prototype.getExternalData=function(e){var t=this.getNamespacedStorageKey(e);return localStorage.getItem(t)},e.prototype.setExternalData=function(e,t){var n=this.getNamespacedStorageKey(e);this.makeSafe(function(){localStorage.setItem(n,t)})()},e.prototype.removeExternalData=function(e){var t=this.getNamespacedStorageKey(e);localStorage.removeItem(t)},e.prototype.arraysEqual=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},e}();t.PermutiveInternals=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.promises={}}return e.prototype.addPromise=function(e,t,n,r){var i=this;e in this.promises||(this.promises[e]={}),this.promises[e][t]=r,window.setTimeout(function(){i.resolvePromise(e,t)},n)},e.prototype.createPromise=function(e,t,n){this.addPromise(e,t,n,r.deferredPromise())},e.prototype.getPromise=function(e,t){return r.lens(this.promises,e,t)},e.prototype.resolvePromise=function(e,t){var n=this.getPromise(e,t);return void 0!==n?(n.resolve(),n):void 0},e.prototype.getPromisesByCategory=function(e){var t=r.lens(this.promises,e)||{};return Object.keys(t).map(function(e){return t[e]})},e}();t.PermutivePromises=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e,t){this._internals=e,(t=t||{}).timeout_seconds=t.timeout_seconds||1800,t.session_data_key=t.session_data_key||"permutive-session",this.options=t,this.session_id=null,this.initialize()}return e.prototype.getSessionId=function(){return this.session_id},e.prototype.newSession=function(e){return{session_id:r.uuidv4(),last_updated:e}},e.prototype.initialize=function(){var e=new Date,t=this._internals.getCookie(this.options.session_data_key),n=this.decodeSessionData(t);if(null===n)n=this.newSession(e);else{var r=this.options.timeout_seconds;e>new Date(n.last_updated.getTime()+1e3*r)?n=this.newSession(e):n.last_updated=e}this.persistSessionData(n),this.session_id=n.session_id},e.prototype.decodeSessionData=function(e){var t=null;try{t=JSON.parse(e)}catch(e){return null}return null!==t&&"object"==typeof t&&t.hasOwnProperty("session_id")&&t.hasOwnProperty("last_updated")&&(t.last_updated=new Date(t.last_updated),!isNaN(t.last_updated.getTime()))?t:null},e.prototype.persistSessionData=function(e){e.last_updated=e.last_updated.toISOString(),this._internals.setCookie(this.options.session_data_key,JSON.stringify(e))},e}();t.SessionManager=i},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=function(){function e(){}return e.prototype.track=function(e){},e.prototype.trackTimeSinceInit=function(e,t){},e.prototype.startTimer=function(e,t){return""},e.prototype.stopTimer=function(e,t){},e}();t.PermutiveMetricsNoOp=a;var o=function(){function e(e,t,n){var r=this;this.sdkInitTimestamp=e,this._internals=t,this.permutive=n,this.sendFrequencyInSeconds=5,this.pendingMetrics=[],this.pendingTimers={},this.permutive.ready(function(){window.setInterval(r.processPending.bind(r),1e3*r.sendFrequencyInSeconds),s.onPageUnload(function(){r.processPending.bind(r)})}),this.track({name:"sdk_initialisation_start_time_seconds",value:e/1e3,labels:{}})}return e.prototype.track=function(e){this.pendingMetrics.push(e)},e.prototype.trackTimeSinceInit=function(e,t){var n=performance.now();this.track({name:e,value:(n-this.sdkInitTimestamp)/1e3,labels:t})},e.prototype.startTimer=function(e,t){var n=performance.now(),r=this.generateRandomKey(e);return this.pendingTimers[r]={startTime:n,labels:t},r},e.prototype.stopTimer=function(e,t){var n=this.pendingTimers[t];if(n){var r=performance.now();this.track({name:e,value:(r-n.startTime)/1e3,labels:n.labels}),delete this.pendingTimers[t]}},e.prototype.processPending=function(){this.pendingMetrics.length>0&&(this._internals.api.metrics({context:{environment:"web",events_count:this._internals.state.eventsCache.all().length,segments_count:Object.keys(this._internals.queryManager.queryStateMap).length},items:this.pendingMetrics}),this.pendingMetrics=[])},e.prototype.generateRandomKey=function(e){return e+"-"+i(Array(24)).map(function(){return Math.random().toString(36)[2]}).join("")},e}();t.PermutiveMetrics=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={success:function(e){},error:function(e,t){}},i=function(){function e(e,t){this._internals=e,this.network=t}return e.prototype.identify=function(e,t){var n=this;if(void 0===t&&(t=r),e.forEach(function(e){return n._internals.identities.addAlias(e.id,e.tag)}),this._internals.isIdentityReady){var i=this._internals.identities.currentAliases;this.sendIdentify(this._internals.state.userId,i,t).then(function(e){return n._internals.identities.storeAliases(i)})}},e.prototype.graphql=function(e,t){return void 0===t&&(t=r),this.network.req({url:this._internals.config.apiProtocol+"://"+this._internals.config.apiHost+"/graphql",method:"POST",success:t.success,error:t.error,data:{query:e},contentType:"text/plain",xhrFields:{withCredentials:!0}},!1)},e.prototype.sendIdentify=function(e,t,n){return void 0===n&&(n=r),this.network.req({url:this.network.getEndpointUrl("/identify"),method:"POST",data:{user_id:e,aliases:this._internals.identities.convertAliases(t)},success:n.success,error:n.error,contentType:"text/plain",xhrFields:{withCredentials:!0}},!1)},e.prototype.setUserProperties=function(e,t){return void 0===t&&(t=r),this.network.req({url:this.network.getEndpointUrl("/users/"+this._internals.state.userId+"/properties"),method:"POST",data:{properties:e},success:t.success,error:t.error,contentType:"text/plain"},!1)},e.prototype.metrics=function(e,t){return void 0===t&&(t=r),this.network.req({url:this.network.getEndpointUrl("/internal/metrics"),method:"POST",data:e,contentType:"text/plain",dataType:"text",success:t.success,error:t.error},!1)},e.prototype.track=function(e,t,n){return this.network.req({url:this.network.getEndpointUrl((Array.isArray(e)?"/batch":"")+"/events")+"?enrich="+!!t.includeResponseBody,method:"POST",data:e,success:t.success,error:t.error,contentType:"text/plain"},n)},e.prototype.events=function(e,t){return void 0===t&&(t=r),this.network.req({url:this.network.getEndpointUrl("/events")+"?user_id="+e+(t.from?"&from="+t.from.toISOString():""),method:"GET",success:t.success,error:t.error,contentType:"text/plain"},!1)},e.prototype.tpdUsage=function(e,t){return void 0===t&&(t=r),this.network.req({url:this.network.getEndpointUrl("/tpd/usage"),method:"POST",data:e,success:t.success,error:t.error,contentType:"text/plain"},!1)},e.prototype.reset=function(){return this.network.req({url:this.network.getEndpointUrl("/reset"),method:"POST",xhrFields:{withCredentials:!0},contentType:"text/plain"},!1)},e.prototype.segmentSync=function(e,t){return this.network.ajax({url:"https://"+this._internals.config.segmentSyncApiHost+"/sync/"+e,type:"POST",data:"value="+encodeURIComponent(t),contentType:"application/x-www-form-urlencoded",xhrFields:{withCredentials:!0}})},e.prototype.models=function(e){var t="binary"===e?"bin":"json";return this.network.ajax({url:"https://"+this._internals.config.cdnBaseUrl+"/models/"+this._internals.config.projectId+"-models."+t,dataType:e})},e}();t.PermutiveApi=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){var n=this;this.userId=e,this.aliases=t,this.resource="userTPD",this.query=function(){var e=n.aliases.map(function(e){return'{id: "'+e.id+'", tag: "'+e.tag+'", priority: '+e.priority+"}"}).join(",");return'\n      userTPD: user(user_id: "'+n.userId+'") {\n        identity(aliases: ['+e+"]) {\n          tpd {\n            name\n            segments\n          }\n        }\n      }\n    "}};t.GraphQLTPD=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.events=[],this.listeners=[]}return e.prototype.newEvent=function(e,t){var n=this;this.events.push([e,t]),this.listeners.forEach(function(r){n.handle(e,t,r)})},e.prototype.addListener=function(e){var t=this;this.listeners.push(e);var n={replay:function(){return t.replay(e),n},remove:function(){return t.remove(e),n}};return n},e.prototype.handle=function(e,t,n){var r="string"==typeof n.name&&e.name===n.name,i=n.name.test&&n.name.test(e.name),s=r||i;if(s)try{n.callback(e,t)}catch(e){window.console&&window.console.error&&window.console.error("callback error: ",e)}s&&n.once&&this.remove(n)},e.prototype.replay=function(e){for(var t=-1!==this.listeners.indexOf(e),n=0;n<this.events.length&&t;n++)this.handle(this.events[n][0],this.events[n][1],e),t=-1!==this.listeners.indexOf(e)},e.prototype.remove=function(e){var t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)},e}();t.EventHandler=r},function(e,t,n){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=n(7),o=n(40),c=n(3),u=function(){function t(e,t,n){this._internals=e,this.permutive=t,this.network=n,this.initialisedAddons=[]}return t.prototype.identify=function(e){var t=this;this._internals.log("<call> identify",e);var n=a.PermutiveIdentities.getAliasesFromIdentifyArg(e),r=s.deferredPromise();if(!this._internals.api)return this.network.error("The API hasn't been loaded.",this._internals.state.userId),r.reject(),r.promise;return this._internals.state.taskQueue.add(new o.Task(function(e){t._internals.log("<task> identify ",n);var i=t._internals.state.userId,s={success:function(s){var a=s.user_id;if(a!==i){var o={error:function(){t.network.error("couldn't retrieve events for user "+a,a),e(),r.resolve()},from:new Date(0)};t._internals.state.reset(),t._internals.state.setUserId(a),t._internals.state.eventsCache.refresh(o).then(function(i){var s=t._internals.state.eventsCache.processRefreshEvents(i,{write:!0});t._internals.queryManager.updateSegmentResults(s),t._internals.queryManager.initWorker(s).then(function(){t._internals.log("<done> identify",n,s),e(),r.resolve()})})}else t._internals.log("<done> identify ",n),e(),r.resolve()},error:function(){t.network.error("Couldn't set identity for user "+i,i),e(),r.resolve()}};t._internals.api.identify(n,s)},{wait_prev:!0,block_next:!0})),r.promise},t.prototype.on=function(e,t){return this._internals.eventHandler.addListener({name:e,callback:t,once:!1})},t.prototype.once=function(e,t){return this._internals.eventHandler.addListener({name:e,callback:t,once:!0})},t.prototype.track=function(){for(var t=this,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var u=i([n[0],n[1]||{},n[2]||{}],3),d=u[0],f=u[1],p=u[2];this._internals.log("<call> track",d);var _=s.deferredPromise();if(!this._internals.api)return this.network.error("The API hasn't been loaded."),_.reject(),_.promise;var m=!!p.isAnalyticsOnly,g=this._internals.sessionManager.getSessionId(),h=this._internals.state.getViewId(),v={success:p.success||function(e){},error:p.error||function(e,t){}},y=function(n){t._internals.log("<task> track",d);var a,o=m?null:t._internals.metrics.startTimer("sdk_events_api_roundtrip_seconds",{}),u=m?null:t._internals.metrics.startTimer("sdk_events_overall_processing_seconds",{}),y=i(t._internals.enrichers.enrich([f,!0]),2),w=y[0],b=y[1],k=r({},w,{client:t._internals.state.getClient()}),S=l(p,b),P={user_id:t._internals.state.userId,name:d,segments:t._internals.queryManager.userSegments,properties:k,session_id:g,view_id:h},E={name:d,properties:k,session_id:g,view_id:h,time:new Date},T=function(e){var n=t._internals.metrics.startTimer("sdk_events_querylanguage_seconds",{});return t._internals.queryManager.update([e]).then(function(){t._internals.metrics.stopTimer("sdk_events_querylanguage_seconds",n),t._internals.metrics.stopTimer("sdk_events_overall_processing_seconds",u)})},I=function(n){t._internals.log("Tracking failed with reason",n);var r={name:P.name,session_id:P.session_id,view_id:P.view_id,properties:P.properties,id:null,time:new Date};return e.resolve({event:r,error:n})},q=function(t){var n=c.isFullPermutiveEventJson(t)?c.deserializeEvent(r({},t,{session_id:P.session_id,view_id:P.view_id})):c.deserializeMinimalEvent(t,P);return e.resolve({event:n,error:null})},x=function(t){return e.resolve(t.error?v.error(t.error.error.message):v.success(t.event))},O=function(n){return n.error||t._internals.state.eventsCache.add(n.event),e.resolve(n)},C=function(n){return t._internals.eventHandler.newEvent(c.serializeEvent(n.event),n.error),e.resolve(n.event)};switch(S){case"immediate":a=s.forP(function(n){var r=i(n,2),s=r[0],a=r[1];return e.all([T(s),t._internals.eventsBatch.add(a,v,S),e.resolve(s)])},function(t){var n=i(t,3),r=(n[0],n[1],n[2]);return e.resolve(r)});break;case"onResponse":a=s.forP(function(e){var n=i(e,2),r=(n[0],n[1]);return t._internals.api.track(r,{includeResponseBody:!0},!1)},function(e){return function(e){return t._internals.metrics.stopTimer("sdk_events_api_roundtrip_seconds",o),c.isEventTrackError(e)?I(e):q(e)}(e)},function(t){return e.all([x(t),O(t),T(t.event),C(t)])},function(t){var n=i(t,4),r=(n[0],n[1],n[2],n[3]);return e.resolve(r)});break;case"deferred":a=s.forP(function(n){var r=i(n,2),s=r[0],a=r[1];return e.all([t._internals.api.track(a,{includeResponseBody:!1},!0),e.resolve(s)])},function(e){var t=i(e,2),n=(t[0],t[1]);return C({event:n,error:null})});break;case"never":a=function(n){var r=i(n,2),s=r[0],a=r[1];return t._internals.eventsBatch.add(a,v,S),e.resolve(s)}}a([E,P]).then(function(r){return _.resolve(r),t._internals.log("<done> track",r.name),n(),e.resolve(r)}).catch(function(e){t._internals.metrics.stopTimer("sdk_events_api_roundtrip_seconds",o),v.error(e),t.network.error(e,t._internals.state.userId)})};return this._internals.state.taskQueue.add(new o.Task(y)),_.promise},t.prototype.trigger=function(e,t,n){var r=this,i=s.deferredPromise();this._internals.log("<call> trigger",e),this._internals.triggerListeners=this._internals.triggerListeners||[];return this._internals.state.taskQueue.add(new o.Task(function(t){r._internals.log("<task> trigger",e);var s=r._internals.messages.on("permutive:query:changed",function(t){t.queryCode===e&&(n(t.result),i.resolve(t.result))});r._internals.triggerListeners.push(s),r._internals.log("<done> trigger",e),t()})),i.promise},t.prototype.query=function(e,t){var n=this,r=s.deferredPromise();this._internals.log("<call> query",e);return this._internals.state.taskQueue.add(new o.Task(function(i){n._internals.log("<task> query",e),n._internals.queryManager.handleResult(e,function(e){t(e),r.resolve(e)}),n._internals.log("<done> query",e),i()})),r.promise},t.prototype.segment=function(e,t){var n=this,r=s.deferredPromise();this._internals.log("<call> segment",e);return this._internals.state.taskQueue.add(new o.Task(function(i){n._internals.log("<task> segment",e),n._internals.queryManager.handleResult(e,function(n){if("boolean"!=typeof n.result)throw new Error("Segment "+e+" is missing boolean result property");t(n.result),r.resolve(n.result)}),n._internals.log("<done> segment",e),i()})),r.promise},t.prototype.segments=function(e,t){var n=this;void 0===t&&(t="all");var r=s.deferredPromise();this._internals.log("<call> segments");return this._internals.state.taskQueue.add(new o.Task(function(i){n._internals.log("<task> segments ("+t+")");var s=function(s){e(s),r.resolve(s),n._internals.log("<done> segments ("+t+")"),i()};"dfp"===t?void 0!==n._internals.addons.dfp&&n._internals.addons.dfp.isReady?s(n._internals.addons.dfp.liveSegments):n._internals.messages.once("permutive:dfp:ready",function(){s(n._internals.addons.dfp.liveSegments)}):s(n._internals.queryManager.userSegments)})),r.promise},t.prototype.reset=function(){var e=this,t=s.deferredPromise();return this._internals.state.reset(),this._internals.api.reset().then(function(n){e._internals.state.setUserId(n.id),e._internals.messages.emit("permutive:reset"),t.resolve()}),t.promise},t.prototype.addon=function(t,i){var s=this;if(-1===this.initialisedAddons.indexOf(t)){this.initialisedAddons.push(t);var a=r({},i,{_internals:this._internals,permutive:this.permutive,network:this.network});switch(t){case"web":e.resolve().then(function(){return n(9)}).then(function(e){return s._internals.addons.web=new e.WebAddon(a)});break;case"publishers":e.resolve().then(function(){return n(10)}).then(function(e){return s._internals.addons.publishers=new e.PublishersAddon(a)});break;case"overlays":e.resolve().then(function(){return n(11)}).then(function(e){return s._internals.addons.overlays=new e.OverlaysAddon(a)});break;case"scriptrunner":e.resolve().then(function(){return n(12)}).then(function(e){return s._internals.addons.scriptrunner=new e.ScriptRunnerAddon(a)});break;case"dfp":e.resolve().then(function(){return n(13)}).then(function(e){return s._internals.addons.dfp=new e.DFPAddon(a)});break;case"smart":case"nativo":case"freewheel":case"gigya":case"facebook_pixel":case"facebook_pixel_v2":case"eyeota_pixel":case"pubmatic":0;break;case"tradedesk":e.resolve().then(function(){return n(14)}).then(function(e){return s._internals.addons.tradedesk=new e.TradeDeskAddon(a)});break;case"adwords":case"dbm":e.resolve().then(function(){return n(15)}).then(function(e){return s._internals.addons.ddp=new e.DDPAddon(a)});break;case"rubicon":case"rubicon_ssp":case"aol":case"lotame":case"tracking_pixel":case"twitter_pixel":case"pinterest_pixel":case"local_storage":case"appnexus":case"appnexus_adserver":case"prebid":0}}else"web"===t&&!0!==i.auto_init&&this._internals.addons[t].reset(i)},t.prototype.ready=function(e,t){void 0===t&&(t="initialised");var n=s.deferredPromise(),r=function(){e(),n.resolve()};switch(t){case"initialised":this._internals.isReady?r():this._internals.messages.on("permutive:ready",r);break;case"realtime":this._internals.isRealtime?r():this._internals.messages.once("permutive:ready",r)}return n.promise},t}();function l(e,t){return e.useBeacon?"deferred":e.isAnalyticsOnly?"never":t?"immediate":"onResponse"}t.PermutiveMethods=u}).call(this,n(1).Promise)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){void 0===t&&(t={}),this.wait_prev=t.wait_prev||!1,this.block_next=t.block_next||!1,this.description=t.description||"",this.started=!1,this.complete=!1,this.task=e}return e.prototype.waits=function(){return this.wait_prev},e.prototype.blocks=function(){return this.block_next},e.prototype.execute=function(e){var t=this;this.started=!0,this.task(function(){t.complete=!0,e()})},e}();t.Task=r},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function t(e){this._internals=e,this.queries={},this.promises={}}return t.prototype.register=function(e){var t=r.deferredPromise();return this.queries[e.resource]=e.query(),this.promises[e.resource]=t,t.promise},t.prototype.run=function(){var t=this;if(0===Object.keys(this.queries).length)return e.resolve();var n=r.deferredPromise();return this._internals.api.graphql(this.toQueryString(this.queries),{success:function(e){Object.keys(t.promises).forEach(function(n){var r=e.data[n];r?t.promises[n].resolve(r):t.promises[n].reject()}),n.resolve()},error:function(e){console.error(e),Object.keys(t.promises).forEach(function(e){return t.promises[e].reject()}),n.reject()}}),n.promise},t.prototype.toQueryString=function(e){return"{ "+Object.keys(e).map(function(t){return e[t]}).join(" ")+" }"},t}();t.GraphQLQuery=i}).call(this,n(1).Promise)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){var n=this;this.userId=e,this.aliases=t,this.resource="userIdentify",this.query=function(){var e=n.aliases.map(function(e){return'{id: "'+e.id+'", tag: "'+e.tag+'", priority: '+e.priority+"}"}).join(",");return'\n      userIdentify: user(user_id: "'+n.userId+'") {\n        identity(aliases: ['+e+"]) {\n          identify {\n            id\n          }\n        }\n      }\n    "}};t.GraphQLIdentify=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){var n=this;this.userId=e,this.from=t,this.resource="userEvents",this.query=function(){return'\n      userEvents: user(user_id: "'+n.userId+'") {\n        events(from: "'+n.from.toISOString()+'") {\n          id\n          name\n          time\n          session_id\n          view_id\n          properties\n        }\n      }\n    '}};t.GraphQLEvents=r},function(e,t,n){"use strict";function r(e){var t={},n=[];(e=e||this).on=function(n,r,i){return(t[n]=t[n]||[]).push([r,i]),e},e.off=function(r,i){r||(t={});for(var s=t[r]||n,a=s.length=i?s.length:0;a--;)i==s[a][0]&&s.splice(a,1);return e},e.once=function(t,r){var i=n.slice.call(arguments,2),s=function(){r(i),e.off(t,s)};return e.on(t,s),e},e.emit=function(r){for(var i,s=t[r]||n,a=s.length>0?s.slice(0,s.length):s,o=0;i=a[o++];)i[0].apply(i[1],n.slice.call(arguments,1));return e}}n.r(t),n.d(t,"Events",function(){return r})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i={default:{apiHost:"api.permutive.com",cdnBaseUrl:"cdn.permutive.com",apiVersion:"v2.0",apiProtocol:"https",loggingEnabled:!1,requestTimeout:5e3,cookieName:"permutive-id",cookieExpiry:(r=new Date,r.setFullYear(r.getFullYear()+3),r.toUTCString()),permutiveDataKey:"permutive-data",stateNamespace:"",sendClientErrors:!0,storeIP:!1,exposeInternals:!1,metricsSamplingPercentage:10,eventsCacheLimitBytes:25e5,segmentSyncApiHost:"88ca3150-0f6f-482a-bbc1-2aa3276b3cab.partner.permutive.app"},production:{},development:{apiProtocol:"http",loggingEnabled:!0,sendClientErrors:!1,exposeInternals:!0}};t.buildConfig=function(e){e.config.cookieDomain="."+function(e){var t=e.match(/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),n=e.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,24}$/i),r=e.match(/localhost/);if(n&&n.length>0){var i=e.split(".").reverse();return i.length>=3&&i[1].match(/^(com|edu|gov|net|mil|org|nom|co|ac|name|info|biz)$/i)?i[2]+"."+i[1]+"."+i[0]:i[1]+"."+i[0]}if(t&&t.length>0)return t[0];if(r&&r.length>0)return"localhost";throw"No domain can be found for cookies"}(window.location.hostname),Object.keys(i.default).forEach(function(t){var n=t;e.config[n]=void 0!==e.config[n]?e.config[n]:i[e.config.environment][n]?i[e.config.environment][n]:i.default[n]})}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),a=n(0),o=function(){function e(e,t){var n=this;this._internals=e,this.network=t,this.timeoutDuration=500,this.maxWaitTime=5e3,this.requests=[],setInterval(function(){n.requests.length>0&&n.flush()},this.maxWaitTime),a.onPageUnload(function(){n.requests.length>0&&n.flush(!0)})}return e.prototype.add=function(e,t,n){this.resetTimeout(),this.requests.push([e,t,n])},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!1);var n=i(this.requests);e||this.trackMetrics(n),this._internals.api.track(n.map(function(e){return e[0]}),{},e).then(function(e){return t.isBatchResponse(e)?t.handleBatchResponse(e,n):null},function(e){return t.network.error(e)}).catch(function(e){return t.network.error(e)}),this.requests=[]},e.prototype.handleBatchResponse=function(e,t){var n=this;e.map(function(e){return e.body}).forEach(function(e,r){var i=t.map(function(e){return e[0]})[r],a=t[r][1],o=t[r][2];s.isEventTrackError(e)?n.handleTrackError(e,i,a.error):n.handleTrackResponse(e,i,a.success,o)})},e.prototype.handleTrackResponse=function(e,t,n,r){var i=s.deserializeMinimalEvent(e,t);n(i),"never"!==r&&(this._internals.state.eventsCache.add(i),this._internals.eventHandler.newEvent(s.serializeEvent(i),null))},e.prototype.handleTrackError=function(e,t,n){var r={name:t.name,session_id:t.session_id,view_id:t.view_id,properties:t.properties,id:null,time:(new Date).toISOString()};n(e.error.message),this._internals.eventHandler.newEvent(r,e),console.error(e)},e.prototype.setTimeout=function(e){var t=this;return window.setTimeout(function(){return t.flush()},e)},e.prototype.resetTimeout=function(){clearTimeout(this.timeout),this.timeout=this.setTimeout(this.timeoutDuration)},e.prototype.trackMetrics=function(e){this._internals.metrics.track({name:"sdk_events_batch_size_total",value:e.length,labels:{}}),this._internals.metrics.track({name:"sdk_events_batch_size_bytes",value:2*JSON.stringify(e.map(function(e){return e[0]})).length,labels:{}})},e.prototype.isBatchResponse=function(e){return!!e},e}();t.PermutiveEventsBatch=o},function(e,t,n){"use strict";(function(e){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(48);function a(e){return"SegmentEntry"===e.name}var o=function(){function t(e,t,n){var r=this;this._internals=e,this.permutive=t,this.network=n,this.initialised=!1,this.stateChangeQueue=[],this.CACHED_SEGMENTS_STORAGE_KEY="_psegs",this.queryMetadata={26399:["c784c76f7e",["s"],"39eb2df0-5a94-4bc0-ba0d-76a0390a6ace"],26604:["a7708dad4c",["s"],"b8c8b300-8c97-41c1-b153-961e5b398022"],26863:["7cd37f5ed5",["s"],"6789c4db-9969-4d13-9878-1dacb06674b0"],26865:["0334c79696",["s"],"aabd9f8f-eb63-45f7-9092-6c890b86d494"],26866:["9070a4d588",["s"],"e9586306-fdf8-456c-bf86-9bdd7077b7e5"],27178:["0c8b70cdb7",["s"],"ca742e34-379e-4a25-94a4-bf0b6caee752"],27541:["76f5f96d9e",["s"],"8f7378b7-f379-4f58-bb5b-bb18b2bc91e0"],27544:["2b1bc4836f",["s"],"30e12504-7611-49dd-b138-7f303d5a1110"],27545:["30b39b113c",["s"],"b4eb586f-a970-4e28-b17e-253abc098de9"],27546:["a067f6c4f6",["s"],"200b641f-7458-49d8-915d-2fb8c5aef37e"],27549:["6ae6414260",["s"],"1cff1728-3b79-45f9-8966-d42ddc462d67"],27550:["d4737c2f53",["s"],"52b31d68-a35d-4db9-ba8f-c4eff609ec1c"],27555:["2e939cf5ed",["s"],"4b08a9d3-e6e6-4d88-845e-3675ceff1bcb"],27945:["341a4ae25f",["s"],"b5c75f35-c1d4-4ce4-b3bd-236985a619d7"],28211:["39febf893e",["s"],"ccf118aa-4b33-4005-83c1-2eea42d8f15f"],28679:["d691ba96a6",["s"],"01a9624c-28dc-4e97-b345-2c1b55ea9dd5"],28680:["f48aac564a",["s"],"0993b7a2-4c08-43f3-a7b0-12f18a68f858"],28681:["6564aeda36",["s"],"3de183ab-35be-45dc-976b-b50fb62fb5cf"],28682:["5f3c50811a",["s"],"3f6590fc-ffb8-4a65-b7fa-82a1a1b543ab"],28683:["84bc4f51c0",["s"],"9386887e-6165-46d9-8e6a-9afeae144b70"],28684:["695e97233d",["s"],"c78ff673-f958-4baa-93b0-be2756f5d89d"],28685:["26097cb663",["s"],"50aa7906-5385-497d-b9b8-1df5602b5440"],28686:["4d3ea466a6",["s"],"bfc3caf0-5ccb-4686-8c1f-ee747138148c"],28687:["46d1bf8d17",["s"],"4bebe7f4-3c2e-460b-94ea-30146c2374b2"],28688:["de895711a7",["s"],"1be9ed01-c1ad-44fd-9f67-1dee8d1c2b1f"],28690:["bd25a44f73",["s"],"9c544584-9c2a-489b-8634-1fa535cbae77"],28691:["f2c9107642",["s"],"ab0a49ec-b80f-4459-9d23-08b4387a6aef"],28692:["0b0f3f6817",["s"],"0765e444-3fa8-4999-b54d-3a91c5a8fca4"],28693:["ff56569463",["s"],"36748157-6c70-4e27-a27f-effb6ba94645"],28694:["2a00f84821",["s"],"1749713f-278f-4f54-9d7c-918732acbe56"],28695:["ee5d6cb65d",["s"],"cf9d469e-e4e8-49c9-8f50-f2a6dc744395"],28696:["63b0230cce",["s"],"8ce0edad-6828-4c49-9d0c-a9128715caca"],28697:["b9b6ea5041",["s"],"f82f7dbe-515e-46e9-8069-55acb7112be6"],28821:["22911a2329",["s"],"181f7ef2-f406-40c7-813c-a65aa845ce08"],29010:["0d7c6270a2",["s"],"b8b68092-42bc-445b-b615-b6ed25e61980"],29093:["8b38c67db2",["s"],"84362c9d-cb7a-446f-a41c-c02c4ec2b1c0"],29102:["ba58fb3830",["s"],"6fca58e4-12ff-4fc2-a878-3b1c74039860"],29220:["4d1c3c5481",["s"],"94460a4c-eae3-4053-a03d-79989bd0ade4"],29578:["6b018fe49d",["s"],"32a8e583-a835-4877-b4ee-470a1e0a3cea"],29580:["c2d0451176",["s"],"d90ca271-52be-42c2-bd5c-5b434743b106"],29586:["e7b3788727",["s"],"d2edba87-4277-416f-9d58-25a15e9f9b25"],29605:["f8aae9c8b7",["s"],"c7b1f78e-b5b8-4921-8bca-79bae9e5ba50"],29606:["d17bbbac3c",["s"],"9f5e0787-589d-42eb-8fa5-976d55e01d9f"],29720:["cb7b8656e6",["s"],"096d6df3-87b6-4f9e-9c56-22b6943d4862"],29745:["6008124eed",["s"],"689218ce-3555-4fba-adce-733007e689ad"],29831:["8bc4adb5db",["s"],"b9544fa0-24c2-4dcf-87bc-3ae4293578a6"],30106:["a64971fe9d",["s"],"f312080f-0133-4140-a2ba-0f3fd7281279"],30109:["a4289ca9fe",["s"],"05c705d4-28fb-4272-a4b2-c81bef0775a6"],30123:["7a72998d78",["s"],"9dd340a7-2124-43c1-ad45-e371291eca56"],30176:["5179874ef9",["s"],"2222cab2-dfcb-46c2-b962-e160cd740dbf"],30400:["7005bb4635",["l","s"],"a59f9797-efe2-4da4-86d0-93c2df7b9be1"],30401:["e995d2bedc",["l","s"],"c53aab8f-bd27-46b6-8383-eaf5fe864372"],30808:["4d3ea466a6",["s"],"f587e5c8-47b2-4e39-b507-f6ed568f0ed6"],30809:["979f3be730",["s"],"82c28122-b1ee-4caa-adf1-7e235f652491"],30810:["4b0f9bf4ed",["s"],"8026fb99-1515-4481-90dd-63f3db41b577"],30811:["4b0f9bf4ed",["s"],"8a49a033-9a7d-4a5b-9305-051992c40454"],30812:["836fc33e15",["s"],"904ce281-d288-4ec4-9ff3-f83e338eb488"],30813:["52e8014be3",["s"],"f5806519-6457-4c62-9277-b6f7e6814015"],30814:["72578c9fb5",["s"],"607a9016-bd85-4c4f-9733-ec1a3f975934"],30815:["cbe710037b",["s"],"3b9dad49-5c30-4caf-9de4-b1ed74d3d6ea"],30816:["5913efbf14",["s"],"3c6c7d87-7178-4edf-9154-621490ab2b52"],30817:["eff87cb3d1",["s"],"92c050f1-59e2-4b7c-9ff8-32911b570dcd"],30820:["afa44a0273",["s"],"ebcd4026-62db-4921-846f-a45c66808234"],30821:["5ff9af59cb",["s"],"31019a15-37b3-4264-ad13-ee0f80151699"],31075:["834ca2cca8",["s"],"7b06b5ab-8d1d-4752-9b8f-391885e63e3e"],31234:["979f3be730",["s"],"8a4f211a-0d6c-4cd6-a42f-da795e1be490"],31281:["2a06b170ea",["s"],"1bbcee34-69bc-4a18-9871-8ab547b870ad"],31381:["f3e847288c",["s"],"f7c88bea-1a7b-4d59-8aa8-7d2a92130901"],31382:["4c8bfd0090",["s"],"3d6fb362-df1b-4154-baf7-d2a8423550b1"],31389:["c2d0451176",["s"],"6fea2e08-e475-47e2-95ac-086ed360d9f9"],31390:["319c137955",["s"],"b9d89ec9-47e0-4358-af4a-b1196ebc65c0"],31391:["e6f6287eea",["s"],"5b57dc4b-6ae4-45e1-8d18-0fe266347a49"],31590:["7ea5456d83",["s"],"369d4541-c823-45e5-b2cb-024319d758f0"],31591:["f9088a7380",["s"],"73fe75e0-c00e-49ec-b92a-1520c8f01f65"],31637:["d58043dd6e",["s"],"59d544f5-7049-4760-8049-db014f6ff2ac"],31638:["b221554e80",["s"],"5f2b3917-bcbb-4a0b-bd02-8a10f4e74ba3"],31639:["83adb54691",["s"],"e8b7d98d-d814-4cf2-9a0c-1e33a99110db"],31787:["56fa4dcbc7",["s"],"2e2d97f4-6e43-4062-a12a-fbcc821790d8"],32281:["48c11ae3a9",["s"],"6888ae33-70c0-42ef-9237-ea5c093ef060"],32377:["17e39a8e0d",["s"],"a0bfefe7-235a-4754-9d4a-ccaa1ff56e5b"],32378:["583f706345",["s"],"5113448b-65f8-409b-b822-5c8d37ebc61e"],32750:["9a19691db8",["s"],"67678472-2730-4e33-b38a-e687e6f4ed7b"],32751:["46e88c0d22",["s"],"6c15a3e0-7556-4ae1-b5d5-623e6207d63b"],32752:["440f2dcffd",["s"],"dabc175c-3512-4648-83c1-7d534841547f"],32754:["2e86a9049f",["s"],"fa7207eb-da9c-4a5e-8c61-0fa74b69107d"],32755:["be2e05626d",["s"],"c7b7a9c2-762c-4ba8-8b21-2dc50900a483"],32756:["d6c057f050",["s"],"92c0486e-e61e-4914-a297-c28b61b8111e"],32865:["a84f2cae5d",["s"],"b5dd5d9a-9ca1-4168-8951-29b963f9d0f9"]},this.userSegments=[],this.userSegmentsDict={},this.queryStateMap={},this.globalMsgId=0,this.resolves={},this.readSegmentCache(),this.readQueryStateCache(),this.handlers={complete:function(e){var t=r.resolves[e];t&&t(),delete r.resolves[e]},errors:function(e){e.forEach(function(e){r.network.error("QL error. "+e.error+" in query "+e.identifier+" with event "+e.event_id,r._internals.state.userId)})},stateChange:function(e){if(!r.initialised)return r.stateChangeQueue.push(e);for(var t in e)if(e.hasOwnProperty(t)){var n=parseInt(t),s=e[n];if(s.is_segment){var a=n in r.userSegmentsDict,o=s.result.result;if(a===o)continue;o?r.addSegment(n):r.removeSegment(n),r.trackSegmentTransition(o,s.id,n)}else{var c=r.queryStateMap[n]||{result:{}};if(JSON.stringify(c.result)===JSON.stringify(s.result))continue}r._internals.messages.emit("permutive:query:changed",{queryCode:n,result:s.result})}Object.keys(e).length>0&&(r.queryStateMap=i.merge(r.queryStateMap,e),r.writeSegmentCache(),r.writeQueryStateCache()),r._internals.messages.emit("permutive:segments:updated")}};var a=new Blob([("("+s.QueryWorker+")();").replace('"use strict";',"")],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(a)),this.worker.onmessage=function(e){switch(e.data.type){case"stateChange":return r.handlers.stateChange(e.data.args);case"errors":return r.handlers.errors(e.data.args);case"complete":return r.handlers.complete(e.data.args)}},this.worker.onerror=function(e){e.preventDefault(),r.network.error("WebWorker error: "+e.message,r._internals.state.userId)}}return t.prototype.initWorker=function(e){return this.sendMessage({type:"init",args:[this.queryMetadata,this.queryStateMap,{segments:{"1p":this.userSegmentsDict},sessionId:this._internals.sessionManager.getSessionId(),viewId:this._internals.state.getViewId(),lookalikeModels:{}},e]})},t.prototype.updateEnvironment=function(e){return this.sendMessage({type:"updateEnvironment",args:[e]})},t.prototype.updateWithHistoricSegments=function(t){return 0===t.length?e.resolve():(this.updateSegmentResults(t),this.sendMessage({type:"processEvents",args:[t]}))},t.prototype.update=function(e){var t=this,n=this.sendMessage({type:"processEvents",args:[e]});return!this._internals.isRealtime&&e.filter(function(e){return"Pageview"===e.name}).length>0&&n.then(function(){t._internals.setAsRealtime()}),n},t.prototype.updateSegmentResults=function(e){var t=this;if(0!==e.length){var n=this.calculateHistoricSegments(e);this._internals.log("New segment states",n),Object.keys(n).forEach(function(e){var r=parseInt(e);n[r]?t.addSegment(r):t.removeSegment(r)}),Object.keys(n).length>0&&this.writeSegmentCache()}},t.prototype.handleResult=function(e,t){e in this.queryStateMap&&t(this.queryStateMap[e].result)},t.prototype.getTpdUsage=function(){for(var e={},t=Object.keys(this.queryStateMap),n=t.length,i=0;i<n;i++){var s=t[i],a=this.queryStateMap[s],o=a.activations;r(a,["activations"]);Object.keys(o).length>0&&(e[s]=o)}return e},t.prototype.reset=function(){this.clearSegmentCache(),this.clearQueryStateCache(),this.userSegments=[],this.userSegmentsDict={},this.queryStateMap={}},t.prototype.setAsReady=function(){this.initialised=!0,this.processStateChangeQueue(),this._internals.messages.emit("permutive:queries:initialised")},t.prototype.getStateSizeInBytes=function(){return 2*JSON.stringify(this.queryStateMap).length},t.prototype.processStateChangeQueue=function(){this._internals.log("state change queue",this.stateChangeQueue);var e=this.stateChangeQueue.reduce(function(e,t){return i.merge(e,t)},{});this.stateChangeQueue=[],this._internals.log("final state",e),this.handlers.stateChange(e)},t.prototype.sendMessage=function(t){var n=this,r=this.globalMsgId++;return new e(function(e,i){n.resolves[r]=e,t.msgId=r,n.worker.postMessage(t)})},t.prototype.addSegment=function(e){this.userSegmentsDict[e]||(this.userSegments.push(e),this.userSegmentsDict[e]=!0,this.updateQlEffectsSegments())},t.prototype.removeSegment=function(e){if(e in this.userSegmentsDict){delete this.userSegmentsDict[e];var t=this.userSegments.indexOf(e);t>-1&&this.userSegments.splice(t,1),this.updateQlEffectsSegments()}},t.prototype.updateQlEffectsSegments=function(){var e=this;this._internals.thirdParty.segments().then(function(t){e.updateEnvironment({segments:i.merge({"1p":e.userSegmentsDict},t)})})},t.prototype.calculateHistoricSegments=function(e){for(var t,n={},r=0;r<e.length;r++){var i=e[r];("SegmentEntry"===(t=i).name||"SegmentExit"===t.name)&&(n[i.properties.segment_number]=a(i))}return n},t.prototype.trackSegmentTransition=function(e,t,n){var r=e?"SegmentEntry":"SegmentExit",i={segment_id:t,segment_number:n};this.permutive.track(r,i)},t.prototype.writeSegmentCache=function(){this._internals.log("Writing segment cache");var e=JSON.stringify(this.userSegments);this._internals.setExternalData(this.CACHED_SEGMENTS_STORAGE_KEY,e)},t.prototype.readSegmentCache=function(){var e=this,t=this._internals.getExternalData(this.CACHED_SEGMENTS_STORAGE_KEY);t&&(this.userSegments=this.filterActiveSegments(JSON.parse(t)),this.userSegments.forEach(function(t){e.userSegmentsDict[t]=!0})),this._internals.log("Read segment cache",this.userSegments)},t.prototype.filterActiveSegments=function(e){var t=this;return e.filter(function(e){return e in t.queryMetadata})},t.prototype.clearSegmentCache=function(){this._internals.removeExternalData(this.CACHED_SEGMENTS_STORAGE_KEY)},t.prototype.writeQueryStateCache=function(){this._internals.log("Writing query state cache",this.queryStateMap),this._internals.state.setPermutiveData("query_states",this.queryStateMap)},t.prototype.readQueryStateCache=function(){var e=this,t=this._internals.state.getPermutiveData("query_states")||{};this.queryStateMap=i.filterByKey(t,function(t){return t in e.queryMetadata}),this._internals.log("Read query state cache",this.queryStateMap)},t.prototype.clearQueryStateCache=function(){this._internals.state.setPermutiveData("query_states",{})},t}();t.QueryManager=o}).call(this,n(1).Promise)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryWorker=function(){var e=this,t=function(){var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},t=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a},n={k:function(e,t){return t.reduce(function(e,t){return e&&null!=e[t]?e[t]:null},e)},kf:function(e,t,n){var r=t.reduce(function(e,t){return e&&null!=e[t]?e[t]:null},e);return null===r?null:n(r)},ti:function(e){return new Date(e).getTime()},pre:function(e,t){var n=t.slice();return n.unshift(e),n},n0:function(e){return!e},nt:function(e){return function(t){return!e(t)}},t:function(e){return!0},a:function(e){return e.reduce(function(e,t){return function(n){return e(n)&&t(n)}})},o:function(e){return e.reduce(function(e,t){return function(n){return e(n)||t(n)}})},i:function(e){return e},as:function(e,t,r){return function(i){return r.reduce(function(r,s){return r&&e(s)(n.k(i,n.pre("properties",t)))},!0)}},os:function(e,t,r){return function(i){return r.reduce(function(r,s){return r||e(s)(n.k(i,n.pre("properties",t)))},!1)}},e:function(e){return function(t){return t===e}},n:function(e){return function(t){return t!==e}},g:function(e){return function(t){return t>e}},ge:function(e){return function(t){return t>=e}},l:function(e){return function(t){return t<e}},le:function(e){return function(t){return t<=e}},b:function(e,t){return function(n){return n>=e&&n<=t}},s:function(e){return function(t){return"string"==typeof e&&"string"==typeof t&&t.toLowerCase().indexOf(e.toLowerCase())>-1}},c:function(e){return function(t){return null!=t&&"object"==typeof t&&t.indexOf(e)>=0}},e_:function(e,t){return function(r){return n.k(r,e)===t}},n_:function(e,t){return function(r){return n.k(r,e)!==t}},g_:function(e,t){return function(r){return n.k(r,e)>t}},ge_:function(e,t){return function(r){return n.k(r,e)>=t}},l_:function(e,t){return function(r){return n.k(r,e)<t}},le_:function(e,t){return function(r){return n.k(r,e)<=t}},b_:function(e,t,r){return function(i){return n.k(i,e)>=t&&n.k(i,e)<=r}},s_:function(e,t){return function(r){var i=n.k(r,e);return"string"==typeof t&&"string"==typeof i&&i.toLowerCase().indexOf(t.toLowerCase())>-1}},c_:function(e,t){return function(r){var i=n.k(r,e);return null!=i&&"object"==typeof i&&i.indexOf(t)>=0}},pe:function(e,t){return function(r){return n.k(r,n.pre("properties",e))===t}},pn:function(e,t){return function(r){return n.k(r,n.pre("properties",e))!==t}},pg:function(e,t){return function(r){return n.k(r,n.pre("properties",e))>t}},pge:function(e,t){return function(r){return n.k(r,n.pre("properties",e))>=t}},pl:function(e,t){return function(r){return n.k(r,n.pre("properties",e))<t}},ple:function(e,t){return function(r){return n.k(r,n.pre("properties",e))<=t}},pb:function(e,t,r){return function(i){return n.k(i,n.pre("properties",e))>=t&&n.k(i,n.pre("properties",e))<=r}},ps:function(e,t){return function(r){var i=n.k(r,n.pre("properties",e));return"string"==typeof t&&"string"==typeof i&&i.toLowerCase().indexOf(t.toLowerCase())>-1}},pc:function(e,t){return function(r){var i=n.k(r,n.pre("properties",e));return null!=i&&"object"==typeof i&&i.indexOf(t)>=0}},te_:function(e,t){return function(r){return n.kf(r,e,n.ti)===t}},tn_:function(e,t){return function(r){return n.kf(r,e,n.ti)!==t}},tg_:function(e,t){return function(r){return n.kf(r,e,n.ti)>t}},tge_:function(e,t){return function(r){return n.kf(r,e,n.ti)>=t}},tl_:function(e,t){return function(r){return n.kf(r,e,n.ti)<t}},tle_:function(e,t){return function(r){return n.kf(r,e,n.ti)<=t}},tb_:function(e,t,r){return function(i){return n.kf(i,e,n.ti)>=t&&n.kf(i,e,n.ti)<=r}},te:function(e){return function(t){return n.kf(t,["time"],n.ti)===e}},tn:function(e){return function(t){return n.kf(t,["time"],n.ti)!==e}},tg:function(e){return function(t){return n.kf(t,["time"],n.ti)>e}},tge:function(e){return function(t){return n.kf(t,["time"],n.ti)>=e}},tl:function(e){return function(t){return n.kf(t,["time"],n.ti)<e}},tle:function(e){return function(t){return n.kf(t,["time"],n.ti)<=e}},tb:function(e,t){return function(r){return n.kf(r,["time"],n.ti)>=e&&n.kf(r,["time"],n.ti)<=t}},af:function(e,t,r,i,s,a){return function(o){var c=n.kf(o,e,function(e){return e.filter(i).map(function(e){return n.k(e,t)}).reduce(s,a)});return r(null===c?a:c)}},af_s:function(e,t,r,i){return void 0===i&&(i=function(e){return!0}),n.af(e,t,r,i,function(e,t){return e+t},0)},af_p:function(e,t,r,i){return void 0===i&&(i=function(e){return!0}),n.af(e,t,r,i,function(e,t){return e*t},1)},af_n:function(e,t,r,i){return void 0===i&&(i=function(e){return!0}),n.af(e,t,r,i,function(e,t){return Math.min(e,t)},Number.POSITIVE_INFINITY)},af_x:function(e,t,r,i){return void 0===i&&(i=function(e){return!0}),n.af(e,t,r,i,function(e,t){return Math.max(e,t)},Number.NEGATIVE_INFINITY)},af_m:function(e,t,r,i){return void 0===i&&(i=function(e){return!0}),function(s){var a=n.kf(s,e,function(e){return e.filter(i)});return null===a||0===a.length?r(0):r(a.map(function(e){return n.k(e,t)}).reduce(function(e,t){return e+t},0)/a.length)}},af_u:function(e,t,r){return void 0===r&&(r=function(e){return!0}),function(i){return n.kf(i,e,function(e){return e.filter(r).map(t).reduce(function(e,t){return e||t},!1)})||!1}},af_i:function(e,t,r){return void 0===r&&(r=function(e){return!0}),function(i){return n.kf(i,e,function(e){return e.filter(r).map(t).reduce(function(e,t){return e&&t},!0)})&&!0}},af_l:function(e,t,r){return void 0===r&&(r=function(e){return!0}),function(i){var s=n.kf(i,e,function(e){return e.filter(r).length});return t(null===s?0:s)}},tp:function(e,t,r,i,s){var a=n.k(e.getSegments(),[t,r])||!1;return s&&(i||a)&&e.setSegmentActivation(t,r,s),a},tpn:function(e,t,r){return n.k(e.getSegments(),[t,r])||!1},oe:function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r},lms:function(e,t,r){var i,s=e||{},a=t[r]||{},o=(a["1p"]||{}).const||0,c=n.oe(a);for(var u in c){var l=n.oe(c[u][1]);for(var d in l)!0===(s[c[u][0]]||{})[l[d][0]]&&(o+=l[d][1])}return i=o,1/(1+Math.pow(Math.E,-i))},fm:function(e,t){return{p:t.p,r:function(n,r){return e(t.r(n,r))},a:t.a}},acq:function(e,t){return{p:function(n,r){return[e.p(n,r),t.p(n,r)]},r:function(n,r){return e.r(n,r[0])&&t.r(n,r[1])},a:{z:[e.a.z,t.a.z],m:function(n,r){return[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]}}}},ocq:function(e,t){return{p:function(n,r){return[e.p(n,r),t.p(n,r)]},r:function(n,r){return e.r(n,r[0])||t.r(n,r[1])},a:{z:[e.a.z,t.a.z],m:function(n,r){return[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]}}}},cw:function(e,t,r){return void 0===r&&(r=n.i),{a:{m:function(e,t){return e+t},z:0},p:function(r,i){return n.k(i,["name"])===e&&t(i)?1:0},r:function(e,t){return r(t)}}},mxw:function(e,t,r,i){void 0===i&&(i=n.i);var s=Number.NEGATIVE_INFINITY;return{a:{m:function(e,t){return e>t?e:t},z:s},p:function(i,a){return n.k(a,["name"])===e&&t(a)?n.k(a,r):s},r:function(e,t){return i(t)}}},vgw:function(e,t,r,i){void 0===i&&(i=n.i);var s={v:0,k:0};return{a:{m:function(e,t){var n=e.k+t.k;return{v:n?e.v+t.k*(t.v-e.v)/n:0,k:n}},z:s},p:function(i,a){return n.k(a,["name"])===e&&t(a)?{v:n.k(a,r),k:1}:s},r:function(e,t){return i(t.v)}}},mnw:function(e,t,r,i){void 0===i&&(i=n.i);var s=Number.POSITIVE_INFINITY;return{a:{m:function(e,t){return e<t?e:t},z:s},p:function(i,a){return n.k(a,["name"])===e&&t(a)?n.k(a,r):s},r:function(e,t){return i(t)}}},sw:function(e,t,r,i){return void 0===i&&(i=n.i),{a:{m:function(e,t){return e+t},z:0},p:function(i,s){return n.k(s,["name"])===e&&t(s)?n.k(s,r):0},r:function(e,t){return i(t)}}},pw:function(e,t,r,i){return void 0===i&&(i=n.i),{a:{m:function(e,t){return e*t},z:1},p:function(i,s){return n.k(s,["name"])===e&&t(s)?n.k(s,r):1},r:function(e,t){return i(t)}}},ctw:function(e,t,r,i){return{a:i?{m:function(e,t){return e.concat(t).slice(-i)},z:[]}:{m:function(e,t){return e.concat(t)},z:[]},p:function(i,s){return n.k(s,["name"])===e&&t(s)?n.k(s,r):[]},r:function(e,t){return t}}},ctv:function(t,r,i,s){function a(e,t){var n=function(e){return{k:e.k,c:1+e.c}},r={arr:[],add:{k:t,c:1}};return t?function(e){return e.arr.concat(e.add)}(e.reduce(function(e,t){return e.add.k===t.k?{arr:e.arr,add:n(t)}:{arr:e.arr.concat(t),add:e.add}},r)):e}return{a:s?{m:function(e,t){return a(e,t).slice(-s)},z:[]}:{m:function(e,t){return a(e,t)},z:[]},p:function(e,s){return n.k(s,["name"])===t&&r(s)?n.k(s,i):null},r:function(t,n){return n.reduce(function(t,n){var r;return e({},t,((r={})[n.k]=n.c,r))},{})}}},ctu:function(e,t,r,i){return{a:i?{m:function(e,t){return e.filter(function(e){return!t.includes(e)}).concat(t).slice(-i)},z:[]}:{m:function(e,t){return e.filter(function(e){return!t.includes(e)}).concat(t)},z:[]},p:function(i,s){return n.k(s,["name"])===e&&t(s)?n.k(s,r):[]},r:function(e,t){return t}}},itp:function(e,t,r,i){return{a:{m:function(e,t){return t},z:!1},p:function(r,i){return n.tpn(r,e,t)},r:function(s,a){return n.tp(s,e,t,r,i)}}},isp:function(e,t,r,i){return{a:{m:function(e,t){return t},z:!1},p:function(r,i){return n.tpn(r,e,t)},r:function(s,a){return n.tp(s,e,t,r,i)}}},ifp:function(e){return{a:{m:function(e,t){return t},z:!1},p:function(t,r){return n.tp(t,"1p",e,!1)},r:function(e,t){return t}}},lm:function(e,t){return{a:{m:function(e,t){return t},z:[]},p:function(t,r){return[n.lms(t.getSegments(),t.getLookalikeModels(),e)]},r:function(e,n){return!!n[0]&&t(n[0])}}},sq:function(e){return{a:{m:function(t,n){return[n[0],e.a.m(null!=t[0]&&t[0][0]===n[0][0]?t[1]:e.a.z,n[1])]},z:[[],e.a.z]},p:function(t,r){return[[t.getCurrentSession()],n.k(r,["session_id"])===t.getCurrentSession()?e.p(t,r):e.a.z]},r:function(t,n){return e.r(t,n[0]!=[]&&n[0][0]===t.getCurrentSession()?n[1]:e.a.z)}}},vq:function(e){return{a:{m:function(t,n){return[n[0],e.a.m(null!=t[0]&&t[0][0]===n[0][0]?t[1]:e.a.z,n[1])]},z:[[],e.a.z]},p:function(t,r){return[[t.getCurrentView()],n.k(r,["view_id"])===t.getCurrentView()?e.p(t,r):e.a.z]},r:function(t,n){return e.r(t,n[0]!=[]&&n[0][0]===t.getCurrentView()?n[1]:e.a.z)}}},ltn:function(e,t,r){return{a:{m:function(e,t){return e.concat(t).slice(-r)},z:[]},p:function(r,i){return n.k(i,["name"])===t?[e.p(r,i)]:[]},r:function(t,n){return e.r(t,n.reduce(function(t,n){return e.a.m(t,n)},e.a.z))}}},ftn:function(e,t,r){return{a:{m:function(e,t){return e.concat(t.slice(0,r-e.length))},z:[]},p:function(r,i){return n.k(i,["name"])===t?[e.p(r,i)]:[]},r:function(t,n){return e.r(t,n.reduce(function(t,n){return e.a.m(t,n)},e.a.z))}}},gb:function(e,t,r){return{a:{m:function(r,i){return Object.keys(r).concat(Object.keys(i)).filter(function(e,t,n){return n.indexOf(e)===t}).sort(function(e,t){return Math.max(n.k(r,[t,1]),n.k(i,[t,1]))-Math.max(n.k(r,[e,1]),n.k(i,[e,1]))}).slice(0,t).reduce(function(t,s){var a=e.a.m(n.k(r,[s,0])||e.a.z,n.k(i,[s,0])||e.a.z);return t[s]=[a,Math.max(n.k(r,[s,1]),n.k(i,[s,1]))],t},{})},z:{}},p:function(t,i){var s,a,o=n.k(i,n.pre("properties",r)),c=e.p(t,i);return null==o||null==(a=c)||"object"==typeof a&&0===Object.keys(a).length||a===e.a.z?{}:((s={})[o]=[c,n.kf(i,["time"],n.ti)],s)},r:function(t,n){var r={};return Object.keys(n).forEach(function(i){return r[i]=e.r(t,n[i][0])}),r}}},tw:function(e,r,i){var s=i||100,a=Math.ceil(r/s),o=function(e,t,n){var i;return[Math.floor((e-r)/a),(i={},i[Math.floor(t/a)]=n,i)]},c=function(t,n){var r=Math.max(t[0],n[0]),i=Object.keys(t[1]).filter(function(e){return e>=r}).concat(Object.keys(n[1]).filter(function(e){return e>=r})).filter(function(e,t,n){return n.indexOf(e)===t}).reduce(function(r,i){var s=e.a.m(t[1][i]||e.a.z,n[1][i]||e.a.z);return s!==e.a.z&&(r[i]=s),r},{});return[r,i]},u=[Number.NEGATIVE_INFINITY,{}],l=function(e){var n=function(n){return n.map(function(n){var r=t(n,3),i=r[0],s=(r[1],r[2]);return o(e.t,s,i)}).reduce(c,u)};return c(n(e.in),n(e.out))};return{a:{m:function(e,t){var n=e.w?l(e):e;return c(n,t)},z:u},p:function(t,r){return o(t.getCurrentTime(),n.kf(r,["time"],n.ti),e.p(t,r))},r:function(t,n){var r=(n.w?l(n):n)[1];return e.r(t,Object.keys(r).reduce(function(t,n){return e.a.m(t,r[n])},e.a.z))}}},q:function(e){return{initial:function(t){return{result:e.a.z}},update:function(t,n,r){return{result:e.a.m(n.result,e.p(t,r))}},result:function(t,n){return{result:e.r(t,n.result)}},m:e.a.m,z:e.a.z,p:e.p,r:e.r}}},r={26399:n.q(n.cw("Pageview",n.pe(["geo_info","country"],"United States"),n.ge(1))),26604:n.q(n.cw("Pageview",n.pe(["geo_info","country"],"Poland"),n.ge(1))),26863:n.q(n.cw("Pageview",n.ps(["client","url"],"gamepedia.com"),n.ge(1))),26865:n.q(n.ocq(n.ocq(n.cw("Pageview",n.a([n.ps(["client","domain"],"fandom.com"),n.ps(["client","user_agent"],"Macintosh")]),n.ge(1)),n.cw("Pageview",n.a([n.ps(["client","domain"],"fandom.com"),n.ps(["client","user_agent"],"Windows NT")]),n.ge(1))),n.cw("Pageview",n.a([n.ps(["client","domain"],"fandom.com"),n.ps(["client","user_agent"],"X11")]),n.ge(1)))),26866:n.q(n.ocq(n.cw("Pageview",n.a([n.ps(["client","domain"],"fandom.com"),n.ps(["client","user_agent"],"Android")]),n.ge(1)),n.cw("Pageview",n.a([n.ps(["client","domain"],"fandom.com"),n.ps(["client","user_agent"],"iPhone")]),n.ge(1)))),27178:n.q(n.cw("Pageview",n.t,n.ge(1))),27541:n.q(n.tw(n.cw("Pageview",n.a([n.pe(["page_info","s0"],"ent"),n.pe(["geo_info","country"],"United States")]),n.ge(1)),6048e5)),27544:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_endcdatabase"),n.ge(3)),2592e6)),27545:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_endcdatabase"),n.ge(1)),2592e6)),27546:n.q(n.tw(n.cw("Pageview",n.a([n.pe(["page_info","s0"],"gaming"),n.pe(["geo_info","country"],"United States")]),n.ge(1)),2592e6)),27549:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","pform"],["3ds","board","ds","mobile","nintendo","ps3","ps2","ps4","psp","switch","wii","pc","xbox360","xboxone"])]),n.ge(1)),6048e5)),27550:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","age"],"25-34"),n.ge(1)),2592e6)),27555:n.q(n.ocq(n.tw(n.cw("Pageview",n.pc(["page_info","pub"],"steam"),n.ge(1)),2592e6),n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_7DaystoDie","_AlbionOnline","_AmericanTruckSimulat","_arksurvivalevolved","_Arma3","_AssassinsCreedOdyssey","_ATLAS","_BlackDesertOnline","_BloonsTD6","_Brawlhalla","_CitiesSkylines","_civilization","_CompanyofHeroes2","_ConanExiles","_CounterStrike","_CrusaderKingsII","_cs","_DARKSOULSIII","_DayZ","_deadbydaylight","_defenseoftheancients","_destinypedia","_DivinityiginalSin2","_DontStarve","_dontstarvegame","_DotaUnderlds","_DyingLight","_EliteDangerous","_EuroTruckSimulat2","_Factio","_Fallout4","_FalloutNewVegas","_FHon","_FINALFANTASYXIVOnline","_footballmanager","_GeometryDash","_gmod","_GrimDawn","_gtawiki","_HeartsofIronIV","_humanfallflat _HuntShowdown","_Kenshi","_KillingFlo2","_left4dead","_Left4Dead2","_MDHAU","_monsterhunter","_nba2k","_NBA2K20","_NoMansSky","_OxygenNotIncluded","_Paladins","_playerunknownsbattlegrounds","_playrust","_rainbowsix","_reddeadredemption","_RimWld","_RiskofRain2","_rocketleague","_SlaytheSpire","_SMITE","_SpaceEngineers","_Spacewar","_stardewvalley","_Stellaris","_teamftress","_Temtem","_terraria","_TheElderScrollsVSkyrim","_TheElderScrollsVSkyrimSpecialEdition","_TheFest","_TheIsle","_TheSims3","_Unturned","_VRChat","_wallpaperengine","_WallpaperEngine","_warframe","_WarThunder","_witcher","_WldofTanksBlitz","_WldofWarships","_XCOM2"])]),n.ge(1)),2592e6))),27945:n.q(n.cw("Pageview",n.pe(["page_info","s1"],"_ucpcommunity"),n.ge(1))),28211:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_enmarveldatabase"),n.ge(1)),2592e6)),28679:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"rpg"),n.ge(1)),2592e6)),28680:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"openworld"),n.ge(1)),2592e6)),28681:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"shooter"),n.ge(1)),2592e6)),28682:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"action"),n.ge(1)),2592e6)),28683:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"drama"),n.ge(1)),2592e6)),28684:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"anime"),n.ge(1)),2592e6)),28685:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"horror"),n.ge(1)),2592e6)),28686:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fps"),n.ge(1)),2592e6)),28687:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"mmo"),n.ge(1)),2592e6)),28688:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"scifi"),n.ge(1)),2592e6)),28690:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","tv"],["amazon","netflix","hulu"])]),n.ge(1)),2592e6)),28691:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","tv"],["abc","cbs","fox","nbc","cw"])]),n.ge(1)),2592e6)),28692:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","tv"],["ae","hbo","history","disney","syfy","spike","showtime"])]),n.ge(1)),2592e6)),28693:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","tv"],"netflix"),n.ge(1)),2592e6)),28694:n.q(n.ocq(n.tw(n.cw("Pageview",n.pc(["page_info","tv"],"hulu"),n.ge(1)),2592e6),n.tw(n.cw("Pageview",n.o([n.os(n.e,["client","referrer"],["http://hulu.com","https://signup.hulu.com/plans","https://signup.hulu.com/account"]),n.os(n.e,["client","url"],["https://signup.hulu.com/account","http://hulu.com"]),n.os(n.e,["client","domain"],["hulu.com","signup.hulu.com"])]),n.ge(1)),2592e6))),28695:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","gnre"],["mystery","crime","thriller"])]),n.ge(1)),2592e6)),28696:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_elderscrolls"),n.ge(1)),2592e6)),28697:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s0"],"gaming"),n.ge(3)),6048e5)),28821:n.q(n.cw("Pageview",n.pe(["geo_info","country"],"United Kingdom"),n.ge(1))),29010:n.q(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_funko","_lego","_toys","_doctor-who-collectors","_airhogs","_americangirls","_backyardigans","_barbie","_bionicle","_bubbleguppies","_buddyfight","_carsmovie","_clubpenguintoys","_disneycarstoys","_disneyjuniorpedia","_disneyplanes","_docmcstuffins","_dora","_equestriagirls","_everafterhigh","_frozen","_furby","_groovygirls","_hatchimals","_herofactory","_hotwheels","_lalaoopsyland","_leapfrog","_legendsofchima","_lego","_legodimensions","_legogames","_legominifiguresonline","_megabloks","_mickeymouseclubhouse","_minecraft","_mixels","_monsterhigh","_mylittlepony","_nerf","_nickjr","_octonauts","_pawpatrol","_pawpatrolfanon","_peppapigwiki","_peppapedia","_pjmask","_pokemon","_powerrangers","_powerpuff","_princesssofia","_shopkins","_skylanders","_spinmaster","_spongebobsquarepants","_starmonsters","_starwarsmerchandise","_teenagemutantninjaturtles","_tenkaiknights","_terraria","_thetrashpack","_thomasthetankengine","_toys","_transformers","_tsumtsum","_tttefriends","_wonderpets!","_yogabbagabba","_yugioh","_zootopia","_roblox","_barney","_sesamestreetmuppets","_fingerlings","_slugterra","_caillou","_clifford","_dragontales","_wordgirl","_peanuts","_numnoms","_lolsurprise","_wildkratts","_magicschoolbus","_magicschoolbusridesagain","_jimmyneutron","_kimpossible","_thelionguard","_pollypocket","_rugrats","_dcanimateduniverse","_inspectorgadget","_lolirock","_phineasandferb","_pingu","_recess","_shimmershine","_riseofthetmnt","_kungfupanda","_scoobydoo","_thezhuzhus","_miaandme","_looneytunes","_oggyandthecockaroaches","_hilda","_mickeyfriends","_fisherprice"])]),n.ge(1)),2592e6),n.tw(n.cw("Pageview",n.pc(["page_info","theme"],"toy"),n.ge(1)),2592e6))),29093:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_dragonballz","_dragonballzroleplaying","_dragonballfighterz","_ultradragonball","_dragonballzteamtraining"])]),n.ge(1)),2592e6)),29102:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_animalcrossing"),n.ge(1)),2592e6)),29220:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","tv"],"amazon"),n.ge(1)),2592e6)),29578:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"thriller"),n.ge(1)),2592e6)),29580:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fantasy"),n.ge(1)),2592e6)),29586:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","lang"],"es"),n.ge(1)),6048e5)),29605:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"rts"),n.ge(1)),2592e6)),29606:n.q(n.tw(n.cw("Pageview",n.a([n.pe(["page_info","s0"],"gaming"),n.pe(["page_info","src"],"mobile")]),n.ge(1)),2592e6)),29720:n.q(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_doom","_doomtown","_doomrpg","_doompedia","_doomevil","_doomcraft","_doomclock","_doombeta","_doomanddestiny","_doomanddestiniy","_doom3mrsmileysheadssafari","_doom3","_doom-gaming","_doom"])]),n.ge(1)),5184e6),n.tw(n.cw("Pageview",n.o([n.pe(["client","referrer"],"https://slayersclub.bethesda.net/en"),n.pe(["client","url"],"https://slayersclub.bethesda.net/en"),n.pe(["client","domain"],"slayersclub.bethesda.net")]),n.ge(1)),5184e6)),n.tw(n.cw("LinkClick",n.pe(["client","domain"],"slayersclub.bethesda.net"),n.ge(1)),5184e6))),29745:n.q(n.tw(n.cw("Pageview",n.a([n.pe(["page_info","s0"],"gaming"),n.pc(["page_info","pform"],"pc")]),n.ge(1)),2592e6)),29831:n.q(n.cw("Pageview",n.a([n.pc(["page_info","media"],"cards"),n.pe(["page_info","s0"],"gaming")]),n.ge(1))),30106:n.q(n.ocq(n.ocq(n.ocq(n.cw("Pageview",n.a([n.pc(["page_info","media"],"cards"),n.pe(["page_info","s0"],"gaming")]),n.ge(1)),n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_finalfantasy","_theouterworlds","_elderscrolls","_thewitcher","_fireemblemheroes","_galaxyofheroes","_gameofwar","_clashroyale"])]),n.ge(1)),2592e6)),n.tw(n.cw("Pageview",n.a([n.o([n.os(n.c,["page_info","gnre"],["strategy","fantasy"])]),n.pe(["page_info","s0"],"gaming")]),n.ge(1)),2592e6)),n.tw(n.cw("SegmentEntry",n.pe(["segment_number"],29831),n.ge(1)),2592e6))),30109:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"moba"),n.ge(1)),2592e6)),30123:n.q(n.ocq(n.tw(n.cw("Pageview",n.a([n.pe(["page_info","s0"],"gaming"),n.pc(["page_info","pform"],"mobile"),n.pc(["page_info","gnre"],"strategy")]),n.ge(1)),2592e6),n.tw(n.cw("SegmentEntry",n.o([n.os(n.e,["segment_number"],[30109,29605])]),n.ge(1)),2592e6))),30176:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"strategy"),n.ge(1)),2592e6)),30400:n.q(n.ocq(n.lm("034ff9a1-d834-49a0-944b-afd05df3a41b",n.ge(.9171135)),n.ifp("29720"))),30401:n.q(n.ocq(n.lm("9abcec87-de94-4f8e-86b3-59406da989fa",n.ge(.9147898)),n.ifp("29831"))),30808:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fps"),n.ge(1)),2592e6)),30809:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"adventure"),n.ge(1)),2592e6)),30810:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"sports"),n.ge(1)),2592e6)),30811:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"sports"),n.ge(1)),2592e6)),30812:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","pform"],"xbox360"),n.ge(1)),2592e6)),30813:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","pform"],"xboxone"),n.ge(1)),2592e6)),30814:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","pform"],"switch"),n.ge(1)),2592e6)),30815:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","pform"],["ps2","ps3","ps4"])]),n.ge(1)),2592e6)),30816:n.q(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_callofduty","_callofdutyzombiesmapsforfree","_callofdutyzombies286","_callofdutyzombies","_callofdutyzombiemode","_callofdutyvideogame","_callofdutytheorys","_callofdutyrp","_callofdutyrm","_callofdutypage","_callofdutynazizombiesfullstoryline","_callofdutynazizombieeastereggsonglist","_callofdutynazizombie","_callofdutymw2409","_callofdutymultiplayer","_callofdutymodernwarfare2514","_callofdutyheadquarters","_callofdutyhandbookx","_callofdutyfanon","_callofdutyfanfiction","_callofdutyclans","_callofdutyblackopszombiesurvivial","_callofdutyblackopszombiesstratergies","_callofdutyblackops690","_callofdutyblackops","_callofdutybestzombiestrategiesandrefrences","_callofdutyanswers","_callofduty-gaming","_callofduty"])]),n.ge(1)),5184e6),n.tw(n.cw("Pageview",n.o([n.pe(["client","referrer"],"https://www.callofduty.com/"),n.pe(["client","url"],"https://www.callofduty.com/"),n.pe(["client","domain"],"callofduty.com")]),n.ge(1)),5184e6)),n.tw(n.cw("LinkClick",n.a([n.pe(["client","domain"],"callofduty.com"),n.pe(["client","url"],"https://www.callofduty.com/"),n.pe(["client","referrer"],"https://www.callofduty.com/")]),n.ge(1)),5184e6))),30817:n.q(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_nba2k"),n.ge(1)),5184e6),n.tw(n.cw("Pageview",n.o([n.pe(["client","referrer"],"https://www.nba2k.com/"),n.pe(["client","url"],"https://www.nba2k.com/"),n.pe(["client","domain"],"nba2k.com")]),n.ge(1)),5184e6)),n.tw(n.cw("LinkClick",n.a([n.pe(["client","domain"],"nba2k.com"),n.pe(["client","url"],"https://www.nba2k.com/"),n.pe(["client","referrer"],"https://www.nba2k.com/")]),n.ge(1)),5184e6))),30820:n.q(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.o([n.pe(["client","referrer"],"https://avengers.square-enix-games.com/en-us/?"),n.pe(["client","url"],"https://avengers.square-enix-games.com/en-us/?"),n.pe(["client","domain"],"avengers.square-enix-games.com")]),n.ge(1)),5184e6),n.tw(n.cw("LinkClick",n.a([n.pe(["client","domain"],"avengers.square-enix-games.com"),n.pe(["client","url"],"https://avengers.square-enix-games.com/en-us/?"),n.pe(["client","referrer"],"https://avengers.square-enix-games.com/en-us/?")]),n.ge(1)),5184e6)),n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_marvelgames205"),n.ge(1)),2592e6))),30821:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_cyberpunk"),n.ge(1)),7776e6)),31075:n.q(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.e,["client","domain"],["movietickets.com","arclightcinemas.com","landmarktheatres.com","regmovies.com","fandango.com","amctheatres.com","atomtickets.com"]),n.os(n.e,["client","url"],["https://www.fandango.com/10001_movietimes","https://www.fandango.com/","https://www.amctheatres.com/showtimes","https://www.amctheatres.com/","https://www.atomtickets.com/theaters","https://www.atomtickets.com/","https://movietickets.com/"])]),n.ge(1)),7776e6),n.tw(n.cw("Pageview",n.pc(["page_info","media"],"movies"),n.ge(1)),2592e6))),31234:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"adventure"),n.ge(1)),2592e6)),31281:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_fortnite"),n.ge(1)),7776e6)),31381:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_disneyzomibes","_disneyzekeandluther","_disneyxdzekenadluther","_disneyxdzekeandluther","_disneyxdspairofkings","_disneyxdslabrats","_disneyxdpairofkings","_disneyxdlabrats","_disneyxdfanon","_disneyxdcrashbernstein","_disneyxd37","_disneyxd","_disneywizardsofwaverlyplace","_disneywizardsofthewaverlyplace","_disneywik","_disneyvillians","_disneyvillans","_disneyvillains","_disneyuniverse","_disneytsumtsum601","_disneytoon","_disneythesuitelifeondeck","_disneythehunchbackofnotredame","_disneytelevisionanimation","_disneyszekeandluther","_disneyswanderoveryonder","_disneystars","_disneyssnap","_disneysshakeitup796","_disneysseestansweb","_disneysseestansbulletin","_disneysperrytheplatypusagentp","_disneyspairofkings","_disneysorandom","_disneysongs","_disneyslemonademouth","_disneysleadingladies","_disneyskyhigh","_disneyskickinit-ent","_disneyskickinit","_disneysjessietvseries","_disneysjessie","_disneysingalongsongs","_disneyshouseofmouse","_disneyshouseofkids","_disneyshercules","_disneysguiltypartytvshow","_disneysgravityfalls465","_disneysgirlvsmonster","_disneysfishhooks","_disneysfillmore","_disneyscode9","_disneysbuddies","_disneysbonkers","_disneysbolt","_disneysavalonhigh","_disneyprincessvillians","_disneyprincesspalacepets","_disneyprincess","_disneyprincesas","_disneyplanes","_disneypixartoystory","_disneypixarstars","_disneypixarcarspedia","_disneypixarcars550","_disneypixarcars","_disneypedias","_disneyparody","_disneyparksfanon","_disneyparkscharacters","_disneyparks","_disneynonsixthsense","_disneynonheldbyastring","_disneynonallreal","_disneynickelodeoncartoonnetwork","_disneynick","_disneymybabysittersavampire","_disneymusic","_disneymovies391","_disneymovies","_disneymoviedictionary","_disneymoviecrossover","_disneyminutemen","_disneymicroheroes","_disneymeettheheroes","_disneymania","_disneymagicalworld","_disneymagicalkingdoms","_disneymagic","_disneylyrics","_disneylabrats","_disneykickinit","_disneyjuniorthechannel","_disneyjuniorrandomepisodes","_disneyjuniorpedia","_disneyjunior","_disneyjr","_disneyjessieseriesfanon","_disneyjessieseries","_disneyjessiefanon","_disneyjessiefanfiction","_disneyjessie896","_disneyjessi","_disneyjesseseries","_disneyinfinity917","_disneyinfinity","_disneyheroines","_disneyheroesbattlemode520","_disneyheroesbattlemode","_disneyhercules","_disneygummibears","_disneygravityfalls","_disneygirlmeetsworld","_disneygforce","_disneygeekcharming","_disneyfishhooks","_disneyfilms","_disneyfillmore","_disneyfaries","_disneyfanon","_disneyfannania","_disneyfanfiction141","_disneyfanfiction","_disneyfandom","_disneyfamilychannel","_disneyfairy","_disneyfairiesfannation","_disneyfairiesfanfic","_disneyfairies412","_disneyfairies","_disneyfaireis","_disneyepicmickeyfanon","_disneyemojiblitz","_disneydinosaur","_disneydestiny","_disneydescendants728","_disneycrossyroad442","_disneycrossovers","_disneycreate","_disneycouples","_disneycomics","_disneycomicbookcollector","_disneycom","_disneycodenine","_disneycode9","_disneycitygirl","_disneycinemagic","_disneycharacters","_disneychannelworld","_disneychanneluniverse","_disneychannelukireland","_disneychanneltvshows","_disneychannelstrellecity","_disneychannelstars","_disneychannelsnap","_disneychannelshows768","_disneychannelshows","_disneychannelsgoodluckcharlie","_disneychannels","_disneychannelroleplay","_disneychanneloriginalmovie","_disneychanneljessie","_disneychannelinfo","_disneychannelhub","_disneychannelfanon","_disneychannelcouncil","_disneychannelalliance","_disneychannela","_disneychannel688","_disneychannel","_disneycgi","_disneycfanon","_disneycartoons445","_disneycarswik","_disneycars","_disneycaribbeanpirates","_disneybuddies","_disneybrandyandmrwhiskers","_disneybolt","_disneyau","_disneyarwin","_disneyantfarm","_disneyanimationcanon","_disneyanimatedhercules","_disneyanimals","_disneyandpixarvillains","_disneyandpixar","_disneyandnickstars","_disneyandnickapedia","_disneyaladdinfanfiction","_disneyaladdincharacters","_disneyactorsfamily","_disneyacademy","_disney365","_disney2","_disney-spanish","_disney-princess","_disney-microheroes","_disney-magical-world","_disney-ent"]),n.pe(["geo_info","country"],"United Kingdom")]),n.ge(1)),5184e6)),31382:n.q(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_minecraftworldedit","_minecraftuniverse","_minecrafttla","_minecraftsurvivor","_minecraftstorymodeships","_minecraftstorymode","_minecraftrecurrentcomplex","_minecraftpocketediton","_minecraftpocketedition-gaming","_minecraftpocketedition","_minecraftpedia","_minecraftpc","_minecraftpaulsoaresjr","_minecraftmusic","_minecraftmodsmc","_minecraftmods","_minecraftmodcustomstuff","_minecraftmob","_minecraftforum","_minecraftfanonsite","_minecraftfanon","_minecraftfanideas","_minecraftfanfictions","_minecraftfanfiction","_minecraftdayz","_minecraftcreepypasta","_minecraftcomputercraft","_minecraftcomputer","_minecraftcomesalive","_minecraftbuildcraft","_minecraftbigdigpack","_minecraftarchaeology","_minecraftaether","_minecraft360","_minecraft-gaming","_minecraft"])]),n.ge(1)),2592e6),n.tw(n.cw("Pageview",n.o([n.pe(["client","referrer"],"https://www.minecraft.net/en-us/"),n.pe(["client","url"],"https://www.minecraft.net/en-us/"),n.pe(["client","domain"],"minecraft.net")]),n.ge(1)),7776e6)),n.tw(n.cw("LinkClick",n.a([n.pe(["client","domain"],"mniecraft.net"),n.pe(["client","url"],"https://www.minecraft.net/en-us/"),n.pe(["client","referrer"],"https://www.minecraft.net/en-us/")]),n.ge(1)),7776e6))),31389:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fantasy"),n.ge(1)),2592e6)),31390:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fantasy"),n.ge(1)),5184e6)),31391:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","gnre"],"fantasy"),n.ge(1)),7776e6)),31590:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_westworld"),n.ge(1)),2592e6)),31591:n.q(n.tw(n.cw("Pageview",n.pe(["page_info","s1"],"_gameofthrones"),n.ge(1)),290304e5)),31637:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","tv"],"hbo"),n.ge(1)),2592e6)),31638:n.q(n.tw(n.cw("Pageview",n.pc(["page_info","tv"],"turner"),n.ge(1)),2592e6)),31639:n.q(n.tw(n.cw("Pageview",n.a([n.pc(["page_info","gnre"],"drama"),n.pc(["page_info","media"],"tv")]),n.ge(1)),2592e6)),31787:n.q(n.ocq(n.ocq(n.ocq(n.tw(n.cw("Pageview",n.o([n.os(n.c,["page_info","age"],["18-24","18-34","25-34"])]),n.ge(1)),2592e6),n.itp("liveramp_Alliant","1000848126",!1,"31787")),n.itp("liveramp_Alliant","1000848136",!1,"31787")),n.itp("eyeota","291",!1,"31787"))),32281:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_assassinscreed","_batmanarkhamcity","_bioshock","_bloodborne","_darksouls","_deusex","_diabloiii","_divinityoriginalsin","_dragonage","_dragon'sdogma","_fallout","_grandtheftauto","_godofwar","_horizonzerodawn","_marvel'sspiderman","_masseffect","_middleearthshadowofmordor","_southparkthestickoftruth","_thelegendofzelda","_thewitcher","_thewitcher3wildhunt","_tombraider","_uncharted:anthem","_borderlands","_cyberpunk2077","_dmc","_devilmaycry5","_doom","_dyinglight2","_farcry","_halo","_rage2","_reddeadredemption2","_residentevil2","_skullandbones","_thedivision2","_elderscrolls","_thelastofus","_wasteland2","_thewatchdogs","_legion"])]),n.ge(1)),2592e6)),32377:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_assassinscreed","_batmanarkhamcity","_bioshock","_bloodborne","_darksouls","_deusex","_diabloiii","_divinityoriginalsin","_dragonage","_dragonsdogma","_fallout","_gtawikia","_gta","_godofwar","_horizonzerodawn","_marvelsspiderman","_masseffect","_middleearthshadowofmordor","_southpark","_zelda","_witcher","_thewitcher3wildhunt","_tombraider","_uncharted"])]),n.ge(1)),2592e6)),32378:n.q(n.tw(n.cw("Pageview",n.o([n.os(n.e,["page_info","s1"],["_anthem","_borderlands","_cyberpunk2077","_dmcdevilmaycry5","_doom","_dyinglight2","_farcry","_halo","_rage2","_reddeadredemption2","_reddeadredemptoin","_residentevil2","_residentevil","_skullandbones","_thedivision2","_theelderscrolls","_thelastofus","_wasteland2","_thewatchdogslegion"])]),n.ge(1)),2592e6)),32750:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","1825141030",!1,"32750")),32751:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","343167490",!1,"32751")),32752:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","163851166",!1,"32752")),32754:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","1394373388",!1,"32754")),32755:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","1789222658",!1,"32755")),32756:n.q(n.isp("liveramp_RiotGames_fandom_88ca31500f6f482abbc12aa3276b3cab","1160033148",!1,"32756")),32865:n.q(n.tw(n.cw("Pageview",n.a([n.o([n.os(n.c,["page_info","age"],["18-24","18-34","25-34"])]),n.pc(["page_info","sex"],"f")]),n.ge(1)),2592e6))};return void 0!==r?r:{}}(),n=null,r=!1,i=[],s={},a={},o=function(t){switch(t.type){case"init":return e.init(t.msgId,t.args[0],t.args[1],t.args[2],t.args[3]);case"processEvents":return e.processEvents(t.msgId,t.args[0]);case"updateEnvironment":return e.updateEnvironment(t.msgId,t.args[0]);default:throw Error("Unexpected message "+t)}},c=function(t){e.postMessage({type:"complete",args:t})},u=function(t){0!==Object.keys(t).length&&e.postMessage({type:"stateChange",args:t})},l=function(t){0!==t.length&&e.postMessage({type:"errors",args:t})},d=function(e,a){var c={},d=[];e.forEach(function(e){var r=t[e],i=s[e];a.forEach(function(t){try{i.state=r.update(n,i.state,t)}catch(n){d.push({error:n.toString(),identifier:e,event_id:t.id})}}),i.result=r.result(n,i.state),c[e]=s[e]}),u(c),l(d),r=!0,i.forEach(o),i=[]};this.init=function(e,r,i,o,u){var l=o.lookalikeModels||{},f=function(e,t,n){var r=s[n].activations;e in r?-1!==r[e].indexOf(t)||r[e].push(t):r[e]=[t]};s=i,a=r,n={getCurrentTime:function(){return new Date},getCurrentSession:function(){return o.sessionId},getCurrentView:function(){return o.viewId},getSegments:function(){return{"1p":o.segments["1p"]}},getLookalikeModels:function(){return l},setThirdPartyActivation:function(e,t){},setSegmentActivation:function(e,t){}};var p=[];Object.keys(a).forEach(function(e){var r=a[e];if(!(e in i)||i[e].checksum!==r[0]){p.push(parseInt(e));var o=t[e],c=o.initial(n);s[e]={id:r[2],is_segment:r[1].indexOf("s")>-1,checksum:r[0],state:c,result:o.result(n,c),activations:{}}}}),d(p,u),n.getSegments=function(){return o.segments},n.setSegmentActivation=f,n.setThirdPartyActivation=f,d(p,[{}]),c(e)},this.updateEnvironment=function(t,s){if(!r)return i.push({msgId:t,type:"updateEnvironment",args:[s]});s.sessionId&&(n.getCurrentSession=function(){return s.sessionId}),s.segments&&(n.getSegments=function(){return s.segments}),s.lookalikeModels&&(n.getLookalikeModels=function(){return s.lookalikeModels}),e.processEvents(t,[{}])},this.processEvents=function(e,o){if(!r)return i.push({msgId:e,type:"processEvents",args:[o]});var d={},f=[];o.forEach(function(e){Object.keys(a).forEach(function(r){var i=t[r],a=s[r].state;try{var o=i.update(n,a,e);JSON.stringify(a)!==JSON.stringify(o)&&(s[r].state=o,s[r].result=i.result(n,o),d[r]=s[r])}catch(t){f.push({error:t.toString(),identifier:r,event_id:e.id})}})}),u(d),l(f),c(e)},onmessage=function(e){o(e.data)}}},function(e,t,n){"use strict";(function(e){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(8),a=function(){function t(t,n){var r=this;this._internals=t,this.network=n,this.MODELS_LAST_UPDATED_KEY="models_last_updated",this.MODELS_DATA_KEY="models_data",this.MODELS_SYNC_TIMEOUT_IN_SECONDS=86400,this.idToProviderMap=i.swap(s.providerToIdMap);var a=this._internals.state.getPermutiveData(this.MODELS_LAST_UPDATED_KEY);isNaN(a)||(new Date).getTime()>a+1e3*this.MODELS_SYNC_TIMEOUT_IN_SECONDS?this.models=this.fetchModels().then(function(e){return r._internals.state.setPermutiveData(r.MODELS_DATA_KEY,e),r._internals.state.setPermutiveData(r.MODELS_LAST_UPDATED_KEY,(new Date).getTime()),e}).catch(function(e){return r.network.error("Failed decoding binary models.\nError: "+e),{}}):this.models=new e(function(e){e(r._internals.state.getPermutiveData(r.MODELS_DATA_KEY))})}return t.prototype.getModels=function(){return this.models},t.prototype.extractModelsFromJsonArray=function(e){for(var t=this,n={},r=function(r){var i=e[r],s=i.weights,a={"1p":{}};void 0!==i.id&&void 0!==s&&(Object.keys(s).forEach(function(e){var n=e.split("-");if(2===n.length){var r=t.idToProviderMap[n[0]],i=n[1];a[r]||(a[r]={}),a[r][i]=s[e]}else a["1p"][e]=s[e]}),n[i.id]=a)},i=0;i<e.length;i++)r(i);return n},t.prototype.decodeModels=function(e){for(var t=[],n=0;n<e.byteLength;){var i=r(this.decodeModel(new DataView(e,n)),2),s=i[0],a=i[1];t.push(s),n+=a}return t},t.prototype.decodeModel=function(e){var t=function(e){var t=function(e,t){var n=function(e,t){var n=e.toString(16);return("0".repeat(t)+n).slice(Math.min(-t,-n.length))};return n(e.getUint32(t),8)+"-"+n(e.getUint16(t+4),4)+"-"+n(e.getUint16(t+6),4)+"-"+n(e.getUint16(t+8),4)+"-"+n(e.getUint32(t+10),8)+n(e.getUint16(t+14),4)}(e,1),n=function(e,t){switch(String.fromCharCode(e.getInt8(t))){case"1":return"1p";case"3":return"3p"}}(e,17),i=e.getInt8(18),s=e.getFloat32(19),a=e.getFloat32(23),o=r(function(e,t,n,r,i){var s=function(e,t,n){return n===e?t:n},a=function(e,t,n,r){return t+(n-t)*r/(Math.pow(2,e)-1)},o={},c=0;do{c=e.getUint16(t);var u=e.getUint16(t+2);t+=4,o[s(0,"const",c)]=a(n,r,i,u)}while(0!==c);return[o,t]}(e,27,i,s,a),2);return[{version:1,id:t,data_preference:n,weights:o[0]},o[1]]};return function(e){var n=e.getInt8(0);switch(n){case 1:return t(e);default:throw new Error("Decoding only supported for version(s): "+[1]+" -- Supplied version: "+n)}}(e)},t.prototype.fetchModels=function(){var e=this,t=function(t,n,r){return e._internals.api.models(t).then(n,r)},n=function(){return t("json",function(t){return e.extractModelsFromJsonArray(t.models)},function(t){return e.network.error("Failed fetching json models.\nError: "+t),{}})};return t("binary",function(t){return e.extractModelsFromJsonArray(e.decodeModels(t))},function(t){return e.network.error("Failed fetching binary models, reverting to JSON.\nError: "+t),n()})},t}();t.PermutiveModels=a}).call(this,n(1).Promise)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.load=function(e,t){e.q.push({functionName:"addon",arguments:["dbm",{}]})}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=function(e){function t(t){var n=e.call(this)||this;return n.replacementMap={$ip_geo_info:t.geo,$ip_isp_info:t.isp,$ip_address:t.ip,$ip_address_hash:t.ip_hash},n}return i(t,e),t}(n(16).SingleEnricher),o=function(e){var t=this;this.resource="geoip",this.query=function(){return"geoip { "+[t.config.includeGeo?"geo { continent country city province postal_code }":"",t.config.includeISP?"isp { isp organization autonomous_system_number autonomous_system_organization }":"",t.config.includeIP?"ip":"",t.config.includeIPHash?"ip_hash":""].join(" ")+" }"},this.config=e};t.GraphQLGeoIP=o,t.register=function(e,t){return e.makeSafe(function(){var n=function(e){e.isp&&(t.context.isp=e.isp.isp,t.context.organization=e.isp.organization,t.context.autonomous_system_number=e.isp.autonomous_system_number,t.context.autonomous_system_organization=e.isp.autonomous_system_organization),e.geo&&(t.context.continent=e.geo.continent,t.context.country=e.geo.country,t.context.city=e.geo.city,t.context.province=e.geo.province,t.context.postal_code=e.geo.postal_code)},r=e.state.getPermutiveData("enricher:geoip");if(r&&r.session_id===e.sessionManager.getSessionId())n(r.data),e.enrichers.register(new a(r.data));else{var i={includeGeo:s.lens({geoip:{}},"geoip","include_geo")||!0,includeISP:s.lens({geoip:{}},"geoip","include_isp")||!0,includeIPHash:s.lens({geoip:{}},"geoip","include_ip_hash")||!0,includeIP:s.lens({geoip:{}},"geoip","include_ip")||!1};e.graphql.register(new o(i)).then(function(t){n(t),e.state.setPermutiveData("enricher:geoip",{session_id:e.sessionManager.getSessionId(),data:t}),e.enrichers.register(new a(t))}).catch(function(t){return e.network.error("Error while registering the geoip enricher: got "+t)})}})()}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(e,t){this._internals=e,this.network=t,this.url="https://ib.adnxs.com/getuidj",this.invalidAliases=["0","-1"]}return t.prototype.getTag=function(){return"appnexus"},t.prototype.getId=function(){var t=this;return this.network.ajax({url:this.url,xhrFields:{withCredentials:!0},timeout:3e3}).then(function(n){return"uid"in n&&t.isValidAlias(n.uid)?e.resolve(n.uid):e.resolve(void 0)},function(n){return t.network.error("Failed to retrieve third-party identity for "+t.getTag(),t._internals.state.userId),e.resolve(void 0)})},t.prototype.getTtlInSeconds=function(){return 86400},t.prototype.usedForThirdPartyData=function(){return!0},t.prototype.isValidAlias=function(e){return-1===this.invalidAliases.indexOf(e)},t}();t.AppNexusIdentityProvider=n,t.register=function(e,t){var r=new n(e,t);e.identities.registerProvider(r)}}).call(this,n(1).Promise)}]);